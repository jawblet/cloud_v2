(this.webpackJsonptest=this.webpackJsonptest||[]).push([[31],{202:function(e,t,n){},203:function(e,t,n){},318:function(e,t,n){var a={"./L0":[165,0],"./L0.js":[165,0],"./L1":[166,1],"./L1.js":[166,1],"./L10":[167,2],"./L10.js":[167,2],"./L11":[168,3],"./L11.js":[168,3],"./L12":[169,4],"./L12.js":[169,4],"./L13":[170,5],"./L13.js":[170,5],"./L14":[171,6],"./L14.js":[171,6],"./L15":[172,7],"./L15.js":[172,7],"./L16":[173,8],"./L16.js":[173,8],"./L17":[174,9],"./L17.js":[174,9],"./L18":[175,10],"./L18.js":[175,10],"./L19":[176,11],"./L19.js":[176,11],"./L2":[177,12],"./L2.js":[177,12],"./L20":[178,13],"./L20.js":[178,13],"./L21":[179,14],"./L21.js":[179,14],"./L22":[180,15],"./L22.js":[180,15],"./L23":[181,16],"./L23.js":[181,16],"./L24":[182,17],"./L24.js":[182,17],"./L25":[183,18],"./L25.js":[183,18],"./L26":[184,19],"./L26.js":[184,19],"./L27":[185,20],"./L27.js":[185,20],"./L28":[186,21],"./L28.js":[186,21],"./L29":[187,22],"./L29.js":[187,22],"./L3":[188,23],"./L3.js":[188,23],"./L30":[189,24],"./L30.js":[189,24],"./L4":[190,25],"./L4.js":[190,25],"./L5":[191,26],"./L5.js":[191,26],"./L6":[192,27],"./L6.js":[192,27],"./L7":[193,28],"./L7.js":[193,28],"./L8":[194,29],"./L8.js":[194,29],"./L9":[195,30],"./L9.js":[195,30]};function c(e){if(!n.o(a,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=a[e],c=t[0];return n.e(t[1]).then((function(){return n(c)}))}c.keys=function(){return Object.keys(a)},c.id=318,e.exports=c},415:function(e,t,n){"use strict";n.r(t);var a={};n.r(a),n.d(a,"water",(function(){return De})),n.d(a,"sand",(function(){return Fe})),n.d(a,"stoneface",(function(){return Se})),n.d(a,"fungus",(function(){return Te})),n.d(a,"buriedTreasure",(function(){return Be})),n.d(a,"clay",(function(){return Ae})),n.d(a,"grass",(function(){return Re}));var c=n(1),r=n(2),s=n.n(r),o=n(30),i=n.n(o),l=(n(202),n(203),n(10)),u=n(17),d=Object(r.createContext)(null),j=n(5),b=n(35);function h(){return Object(c.jsx)("div",{className:"loading",children:"Loading..."})}function m(){return Object(c.jsx)("div",{className:"loadingPage",children:Object(c.jsx)("h3",{className:"loadingPage__text",children:". . ."})})}function p(e){var t=Object(r.useContext)(d),n=t.user,a=t.isLoading,s=e.component,o=Object(b.a)(e,["component"]);return a?Object(c.jsx)(m,{}):n?Object(c.jsx)(u.b,Object(j.a)(Object(j.a)({},o),{},{render:function(e){return Object(c.jsx)(s,Object(j.a)({},e))}})):Object(c.jsx)(u.a,{to:"/home"})}var f=n(4),O=function(e){var t=e.nav;return Object(c.jsxs)("div",{className:"breadcrumbsNav",children:[Object(c.jsx)(l.c,{to:"/",children:Object(c.jsx)("h4",{children:"arrive anywhere"})}),t&&t.map((function(e,t){return Object(c.jsxs)("h4",{children:[Object(c.jsx)("span",{className:"crumb__break",children:"/"}),Object(c.jsx)(l.c,{to:"/".concat(e.url),className:"crumb",activeClassName:"crumb--active",children:e.name})]},t)}))]})},g=function(e){var t=e.crumbs,n=e.active;return Object(c.jsx)("div",{className:"breadcrumbs",children:t.map((function(e){return Object(c.jsx)("h4",{className:"crumb--w ".concat(n===e?"active":""),children:e},e)}))})};function x(e){var t=e.fail,n=e.white;return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("input",{type:e.type,className:"input\n                ".concat(n?"input--white":""," \n                ").concat(t?"input--fail":""," "),placeholder:e.placeholder,disabled:e.disabled,name:e.name,value:e.value,onChange:e.handleChange,onKeyDown:e.handleKeyDown})})}var v=n(96);function y(e){var t=e.fail,n=function(e){var t=Object(r.useState)(e),n=Object(f.a)(t,2),a=n[0],c=n[1];return{newState:a,handleToggle:function(){c(!a)}}}(!1),a=n.newState,s=n.handleToggle;return Object(c.jsxs)("div",{className:"flex column",children:[Object(c.jsxs)("div",{className:"input__pass",children:[Object(c.jsx)("input",{type:a?"text":"password",className:"input ".concat(t?"input--fail":null," "),placeholder:e.placeholder,name:e.name,value:e.value,onChange:e.handleChange,onKeyDown:e.handleKeyDown,style:{marginBottom:"1.5rem"}}),Object(c.jsx)("span",{className:"showPasswordButton",onClick:s,children:a?Object(c.jsx)(v.b,{className:"icon"}):Object(c.jsx)(v.a,{className:"icon"})})]}),Object(c.jsx)("input",{type:a?"text":"password",className:"input ".concat(t?"input--fail":null," "),placeholder:e.placeholderConfirm,name:e.nameConfirm,value:e.valueConfirm,onChange:e.handleChange,onKeyDown:e.handleKeyDown})]})}function _(e){var t=e.values,n=e.invalidFields,a=e.handleChange,r=["password","passwordConfirm"],s=n.some((function(e){return-1!==r.indexOf(e)}));return Object(c.jsxs)("span",{className:"formFields",children:[Object(c.jsx)(x,{type:"text",placeholder:"Email",name:"email",value:t.email,fail:n.includes("email"),handleChange:a}),Object(c.jsx)(x,{type:"text",placeholder:"Username",name:"username",value:t.username,fail:n.includes("username"),handleChange:a}),Object(c.jsx)(y,{type:"password",fail:s,placeholder:"Password",placeholderConfirm:"Confirm password",name:"password",nameConfirm:"passwordConfirm",value:t.password,valueConfirm:t.passwordConfirm,handleChange:a})]})}function C(e){return Object(c.jsx)("button",{className:"btn CTA ".concat(e.color," ").concat(e.kind),"data-id":e.id,type:e.type,onClick:e.handleClick,children:Object(c.jsx)("h4",{children:e.name})})}function N(e){return Object(c.jsx)("div",{className:"notification error",children:Object(c.jsx)("h5",{children:e.error})})}function w(e){var t=e.type,n=e.prompt,a=e.handleClick;return Object(c.jsx)("h5",{className:"prompt ".concat(t),onClick:a,children:n})}var k=n(12),E=n(3),D=n.n(E),F=n(6),S=n(34),T=n(7),B=n.n(T);function A(e){var t=e.initialValues,n=Object(u.g)(),a=Object(r.useContext)(d),c=a.user,o=a.setUser,i=Object(r.useState)(t||{}),l=Object(f.a)(i,2),b=l[0],h=l[1],m=Object(r.useState)(null),p=Object(f.a)(m,2),O=p[0],g=p[1],x=Object(r.useState)(null),v=Object(f.a)(x,2),y=v[0],_=v[1],C=function(){var e=Object(F.a)(D.a.mark((function e(t){var a,c,r,s,i;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.values,c=a.username,r=a.email,s=a.password,i=a.passwordConfirm,e.prev=1,e.next=4,B()({method:"POST",url:"auth/register",data:{username:c,email:r,password:s,passwordConfirm:i}}).then((function(e){console.log(e);var t=e.data.data.user;o(t),n.push("/register#rent")}));case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(1),console.log(e.t0),g(e.t0.response.data);case 10:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}(),N=function(e){var t=e.values,a=t.house,r=t.boardersUnconfirmed;B.a.post("houses",{house:a,boardersUnconfirmed:r,boarders:c._id}).then((function(e){console.log(r),0!==r.length&&function(e,t){console.log("boarders r emailed"),B.a.post("/houses/email",{house:e,users:t}).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))}(a,r);var t=e.data.data.doc._id;return B.a.put("users/".concat(c._id),{house:t})})).then((function(){return B.a.get("/user").then((function(e){o(e.data.currentUser),n.push("/")}))})).catch((function(e){g(e.response.data),console.log(e)}))},w=function(){var e=Object(F.a)(D.a.mark((function e(t){var a,c,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.values,c=a.username,r=a.password,e.next=3,B.a.post("auth/login",{username:c,password:r}).then(Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("/user").then((function(e){o(e.data.currentUser),n.push("/")}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e.response.data),g(e.response.data)}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var e=Object(F.a)(D.a.mark((function e(t){var n,a,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.values,a=n.username,r=n.email,_(null),g(null),e.prev=3,e.next=6,B()({method:"PUT",url:"users/".concat(c._id),data:{username:a,email:r}}).then((function(e){_("Profile update complete.")}));case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),console.log(e.t0),g(e.t0.response.data);case 12:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t){return e.apply(this,arguments)}}(),T=function(){var e=Object(F.a)(D.a.mark((function e(t){var n,a,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.values,a=n.password,r=n.passwordConfirm,_(null),g(null),e.prev=3,e.next=6,B()({method:"PUT",url:"/auth/password/".concat(c._id),data:{password:a,passwordConfirm:r}}).then((function(e){_("Profile update complete.")}));case 6:e.next=12;break;case 8:e.prev=8,e.t0=e.catch(3),console.log(e.t0),g(e.t0.response.data);case 12:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t){return e.apply(this,arguments)}}(),A=s.a.createRef(),R=function(){if(!/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/.test(b.input))return g({messages:"Email address is not valid.",fields:["email"]});if(b.boardersUnconfirmed.length<4){if(b.boardersUnconfirmed.includes(b.input))return g({messages:"That email address was already added.",fields:["email"]});var e=b.input.trim();h(Object(j.a)(Object(j.a)({},b),{},{boardersUnconfirmed:[].concat(Object(k.a)(b.boardersUnconfirmed),[e])})),g(null),L()}},L=function(){A.current.value=""};return{handleChange:function(e){var t=e.target.value,n=e.target.name;h(Object(j.a)(Object(j.a)({},b),{},Object(S.a)({},n,t)))},handleSubmit:function(e){switch(e.preventDefault(),b.form){case"register":C({values:b});break;case"login":w({values:b});break;case"user":E({values:b}),(b.password||b.passwordConfirm)&&T({values:b});break;case"rent":N({values:b});break;default:return}},values:b,error:O,success:y,searchRef:A,addTags:R,clearInput:L,removeTag:function(e){var t=b.boardersUnconfirmed.filter((function(t){return t!==e}));h(Object(j.a)(Object(j.a)({},b),{},{boardersUnconfirmed:t}))},handleKeyDown:function(e){A.current&&(188!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),R()))}}}function R(){var e,t=A({initialValues:{form:"register",email:"",username:"",password:"",passwordConfirm:""}}),n=t.values,a=t.handleChange,r=t.handleSubmit,s=t.error;return e=s?s.fields:[],Object(c.jsxs)("div",{className:"inlineForm",children:[Object(c.jsx)("h3",{children:"Register"}),Object(c.jsx)("div",{className:"inlineForm__notif",children:s&&Object(c.jsx)(N,{error:s.messages})}),Object(c.jsxs)("form",{onSubmit:r,children:[Object(c.jsx)(_,{values:n,handleChange:a,handleSubmit:r,invalidFields:e}),Object(c.jsxs)("div",{className:"inlineForm__submit",children:[Object(c.jsx)(l.b,{to:"/login",children:Object(c.jsx)(w,{prompt:"Existing account? Log in."})}),Object(c.jsx)(C,{name:"register",kind:"primary",type:"submit"})]})]})]})}var L=n(8);function I(e){var t=e.tags,n=e.handleDelete;return Object(c.jsx)(c.Fragment,{children:t.length>0&&Object(c.jsx)("div",{className:"tagBank",children:t.map((function(e){return Object(c.jsxs)("div",{className:"tag tag--edit",style:{marginBottom:"0.5rem"},children:[Object(c.jsx)("h4",{children:e.tag||e}),Object(c.jsx)(L.i,{className:"tag__X",onClick:function(){return n(e)}})]},e._id||e)}))})})}function P(e){var t,n=e.toggleState,a=e.handleToggle,r=e.label;return t=n?"on":"",Object(c.jsxs)("div",{className:"toggle__wrapper",children:[Object(c.jsx)("div",{className:"toggle ".concat(t),onClick:a,children:Object(c.jsx)("span",{className:"toggle__switch"})}),Object(c.jsx)("h4",{children:r})]})}var K=Object(r.forwardRef)((function(e,t){var n=e.values.input,a=Object(r.useState)(!1),s=Object(f.a)(a,2),o=s[0],i=s[1];return Object(c.jsx)("div",{className:"searchContainer",children:Object(c.jsxs)("div",{className:"search",children:[o&&Object(c.jsx)("div",{className:"search__icon",children:Object(c.jsx)(L.i,{className:"icon icon__btn icon--small",onClick:e.clearInput})}),Object(c.jsx)("input",{type:"text",name:"input",value:n,className:"input search__bar",ref:t,placeholder:e.placeholder,onChange:e.handleChange,onKeyDown:e.handleKeyDown,onFocus:function(){i(!0)}}),o&&Object(c.jsx)("div",{className:"search__icon--end",onClick:e.addTags,children:Object(c.jsx)(L.a,{className:"icon icon__btn icon--small"})})]})})})),M=n(416),z=n(417);function U(){var e=Object(r.useState)(!1),t=Object(f.a)(e,2),n=t[0],a=t[1],s=A({initialValues:{form:"rent",house:"",input:"",boardersUnconfirmed:[]}}),o=s.handleChange,i=s.handleSubmit,l=s.values,u=s.error,d=s.searchRef,j=s.addTags,b=s.clearInput,h=s.removeTag,m=s.handleKeyDown;return Object(c.jsxs)("div",{className:"inlineForm",children:[Object(c.jsx)("h3",{children:"Rent a house"}),Object(c.jsx)("div",{className:"inlineForm__notif",children:u&&Object(c.jsx)(N,{error:u.messages})}),Object(c.jsxs)("form",{className:"formFields",onSubmit:i,children:[Object(c.jsx)(x,{type:"text",placeholder:"House name",name:"house",values:l.house,handleChange:o}),Object(c.jsx)(P,{handleToggle:function(){return a(!n)},toggleState:n,label:"Add other boarders by email"}),Object(c.jsx)(M.a,{mode:"out-in",children:Object(c.jsx)(z.a,{timeout:350,classNames:"rollDownFadeOut",addEndListener:function(e,t){e.addEventListener("transitionend",t,!1)},children:n?Object(c.jsxs)("div",{className:"addBoarders",children:[Object(c.jsx)(K,{placeholder:"Enter up to 3 email addresses.",name:"input",values:l.input,handleChange:o,addTags:j,clearInput:b,ref:d,handleKeyDown:m}),Object(c.jsx)(I,{tags:l.boardersUnconfirmed,handleDelete:h})]}):Object(c.jsx)(w,{prompt:"You won't be able to add boarders later.",type:"light"})},n)}),Object(c.jsx)("div",{className:"inlineForm__submit",style:{justifyContent:"flex-end"},children:Object(c.jsx)(C,{name:"finish",kind:"primary",type:"submit"})})]})]})}function H(e){var t=Object(r.useState)(!0),n=Object(f.a)(t,2),a=n[0],s=n[1],o=Object(r.useState)("register"),i=Object(f.a)(o,2),l=i[0],u=i[1];return Object(r.useEffect)((function(){"#rent"===e.location.hash&&(s(!1),u("rent"))}),[e]),Object(c.jsxs)("div",{className:"page",children:[Object(c.jsx)("div",{style:{width:"35%",marginTop:"3rem",paddingBottom:"5rem"},children:Object(c.jsx)(g,{crumbs:["register","rent"],active:l})}),a?Object(c.jsx)(R,{}):Object(c.jsx)(U,{})]})}function G(){var e,t=A({initialValues:{form:"login",username:"",password:""}}),n=t.values,a=t.handleChange,r=t.handleSubmit,s=t.error;return e=s?s.fields:[],console.log(s),console.log(e),Object(c.jsx)("div",{className:"page",style:{justifyContent:"center"},children:Object(c.jsxs)("div",{className:"inlineForm",children:[Object(c.jsx)("h3",{children:"Login"}),Object(c.jsx)("div",{className:"inlineForm__notif",children:s&&Object(c.jsx)(N,{error:s.messages})}),Object(c.jsxs)("form",{onSubmit:r,className:"formFields",children:[Object(c.jsx)(x,{type:"text",placeholder:"Username",name:"username",value:n.username,fail:e.includes("username"),handleChange:a}),Object(c.jsx)(x,{type:"password",placeholder:"Password",name:"password",value:n.password,fail:e.includes("password"),handleChange:a}),Object(c.jsxs)("div",{className:"inlineForm__submit",children:[Object(c.jsx)(l.b,{to:"/register",children:Object(c.jsx)(w,{prompt:"No account? Create one."})}),Object(c.jsx)(C,{name:"login",kind:"primary",type:"submit"})]})]})]})})}function q(){var e,t=function(e){var t=e.initialValues,n=Object(u.g)(),a=Object(r.useContext)(d).setUser,c=Object(r.useState)(t||{}),s=Object(f.a)(c,2),o=s[0],i=s[1],l=Object(r.useState)(null),b=Object(f.a)(l,2),h=b[0],m=b[1],p=function(e,t){if(!t.boardersUnconfirmed.includes(e.email))return m({messages:"That email isn't associated with a boarder in this house.",fields:["email"]}),null;O(e,t)},O=function(e,t){var c=e.username,r=e.email,s=e.password,o=e.passwordConfirm;B.a.post("auth/register",{username:c,email:r,password:s,passwordConfirm:o,house:t._id}).then((function(n){console.log(n);var a=n.data.data.user,c=t.boardersUnconfirmed.filter((function(t){return t!==e.email})),r=[].concat(Object(k.a)(t.boarders),[a._id]);return B.a.put("houses/".concat(t._id),{boardersUnconfirmed:c,boarders:r})})).then(Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("/user").then((function(e){a(e.data.currentUser),n.push("/home")}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).catch((function(e){console.log(e),m(e.response.data)}))};return{values:o,handleChange:function(e){var t=e.target.value,n=e.target.name;i(Object(j.a)(Object(j.a)({},o),{},Object(S.a)({},n,t)))},error:h,handleCheckHouse:function(e){var t=e.values,n=Object.entries(t).forEach((function(e){var t=Object(f.a)(e,2),n=t[0];if(""===t[1])return n}));if(n&&0!==n.length)return m({messages:"No field may be blank.",fields:n}),null;var a=t.house;B.a.get("/houses/h/".concat(a)).then((function(e){console.log(e);var n=e.data.data.results[0];p(t,n)})).catch((function(e){console.log(e)}))}}}({initialValues:{email:"",username:"",password:"",passwordConfirm:"",house:""}}),n=t.values,a=t.handleChange,s=t.handleCheckHouse,o=t.error;e=o?o.fields:[];return Object(c.jsx)("div",{className:"page",style:{justifyContent:"center"},children:Object(c.jsxs)("div",{className:"inlineForm",children:[Object(c.jsx)("h3",{children:"Confirm"}),Object(c.jsx)("div",{className:"inlineForm__notif",children:o?Object(c.jsx)(N,{error:o.messages}):Object(c.jsxs)("p",{children:["To join the house, register with ",Object(c.jsx)("br",{})," the email address you used to open this link."]})}),Object(c.jsxs)("form",{onSubmit:function(e){e.preventDefault(),s({values:n})},children:[Object(c.jsx)(_,{values:n,handleChange:a,invalidFields:e}),Object(c.jsx)("div",{className:"flex justifyStart padBottomOne",children:Object(c.jsx)(w,{prompt:"Enter the house name in the email.",type:"light"})}),Object(c.jsx)(x,{type:"text",placeholder:"House",name:"house",value:n.house,fail:e.includes("house"),handleChange:a}),Object(c.jsx)("div",{className:"inlineForm__submit",style:{justifyContent:"flex-end"},children:Object(c.jsx)(C,{name:"register",kind:"primary",type:"submit"})})]})]})})}function W(e){return Object(c.jsx)("h4",{className:"btn CTA inline",type:e.type,onClick:e.handleClick,children:e.name})}var Z=[{id:0,name:"library",url:"library",icon:Object(c.jsx)(L.b,{className:"icon icon__btn","data-id":"library"})},{id:1,name:"paths",url:"library/paths",icon:Object(c.jsx)(L.r,{className:"icon icon__btn","data-id":"paths"})},{id:2,name:"add",url:"add",icon:Object(c.jsx)(L.a,{className:"icon icon__btn","data-id":"add"})}],V=[{id:0,name:"link",icon:Object(c.jsx)(L.o,{className:"icon icon__btn"})},{id:1,name:"note",icon:Object(c.jsx)(L.w,{className:"icon icon__btn"})}],X=[{label:"Paragraph",id:"paragraph"},{label:"H1",id:"header-one"},{label:"H2",id:"header-two"},{label:"H3",id:"header-three"},{label:"H4",id:"header-four"},{label:"H5",id:"header-five"},{label:"H6",id:"header-six"}],J=[{label:"bold",style:"BOLD",icon:Object(c.jsx)(L.g,{className:"icon icon__btn"})},{label:"italic",style:"ITALIC",icon:Object(c.jsx)(L.n,{className:"icon icon__btn"})},{label:"monospace",style:"CODE",icon:Object(c.jsx)(L.j,{className:"icon icon__btn"})}],Y=[{id:0,name:"Add path",icon:Object(c.jsx)(L.r,{className:"icon icon__btn"})}],$=[{label:"Blockquote",style:"blockquote",icon:Object(c.jsx)(L.u,{className:"icon icon__btn"})},{label:"UL",style:"unordered-list-item",icon:Object(c.jsx)(L.q,{className:"icon icon__btn"})},{label:"OL",style:"ordered-list-item",icon:Object(c.jsx)(L.p,{className:"icon icon__btn"})},{label:"Code Block",style:"code-block",icon:Object(c.jsx)(L.v,{className:"icon icon__btn"})}],Q=function(){return Object(c.jsxs)("div",{children:[Object(c.jsxs)("h5",{children:[" Highlight the path text and click the",Object(c.jsx)("span",{className:"highlight",children:" add path "}),"button in the toolbar: "]}),Object(c.jsx)("div",{style:{paddingTop:"1rem",textAlign:"center"},children:Object(c.jsx)(L.r,{className:"icon icon__btn"})})]})},ee={dataId:"zoomIn",icon:Object(c.jsx)(L.z,{className:"icon icon__btn","data-id":"zoomIn"})},te={dataId:"zoomOut",icon:Object(c.jsx)(L.y,{className:"icon icon__btn","data-id":"zoomOut"})};function ne(){return Object(c.jsxs)("div",{className:"page",children:[Object(c.jsxs)("header",{className:"landing__header",children:[Object(c.jsx)(l.b,{to:"/login",children:Object(c.jsx)(W,{name:"login"})}),Object(c.jsx)(l.b,{to:"/register",children:Object(c.jsx)(W,{name:"register"})})]}),Object(c.jsx)("section",{className:"landing__body",children:Object(c.jsxs)("h1",{children:[Object(c.jsx)("span",{className:"light",children:"return home, "}),"arrive anywhere"]})})]})}function ae(e){var t=e.nav,n=Object(r.useContext)(d).user,a=function(){var e=Object(u.g)();return{logoutUser:function(){var t=Object(F.a)(D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,B()({method:"GET",url:"/auth/logout"}).then((function(t){e.push("/home")}));case 3:t.next=8;break;case 5:t.prev=5,t.t0=t.catch(0),console.log(t.t0);case 8:case"end":return t.stop()}}),t,null,[[0,5]])})));return function(){return t.apply(this,arguments)}}()}}().logoutUser;return Object(c.jsxs)("header",{className:"page__header",children:[Object(c.jsx)("div",{className:"page__links",children:Object(c.jsx)(O,{nav:t})}),Object(c.jsxs)("div",{className:"page__links",children:[Object(c.jsx)(l.b,{to:"/user",children:Object(c.jsx)(W,{name:"@".concat(n.username)})}),Object(c.jsx)(W,{name:"logout",handleClick:a})]})]})}var ce=function(e){return Object(c.jsx)("div",{style:function(e){var t=e.columns,n=e.rows,a=e.autoColumns,c=e.autoRows,r=e.gap,s=e.justify,o=e.align,i=e.width;return{display:e.inline?"inline-grid":"grid",gap:"".concat(r,"rem")||!1,gridTemplateColumns:t||"none",gridTemplateRows:n||"none",gridAutoColumns:a||"auto",gridAutoRows:c||"auto",justifyItems:s||"stretch",alignItems:o||"stretch",width:i||"100%"}}(e),className:e.className,children:e.children})},re=function(e){return Object(c.jsx)(l.b,{to:e.slug,children:Object(c.jsx)("h4",{className:"subtitle ".concat(e.heavy?"heavy":""),style:{paddingBottom:e.p},children:e.label})})};function se(){var e=Object(r.useContext)(d).user.house._id,t=Object(r.useState)(null),n=Object(f.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(!0),o=Object(f.a)(s,2),i=o[0],l=o[1];return{loading:i,posts:a,getLayerPosts:function(){var t=Object(F.a)(D.a.mark((function t(n){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",B.a.get("/posts/h/".concat(e,"/").concat(n)).then((function(e){var t=e.data.data.results;c(t),l(!1)})).catch((function(e){return console.log(e)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getPathPosts:function(){var t=Object(F.a)(D.a.mark((function t(n){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",B.a.get("/posts/details/".concat(e,"/").concat(n)).then((function(e){var t=e.data.data.posts;c(t),l(!1)})).catch((function(e){return console.log(e)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),getHousePosts:function(){var t=Object(F.a)(D.a.mark((function t(n){var a;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=20*(n-1),t.abrupt("return",B.a.get("/posts/grid/".concat(e,"?offset=").concat(a)).then((function(e){var t=e.data.posts;c(t),l(!1)})).catch((function(e){return console.log(e)})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}}function oe(e){var t=e.tag,n=e.count,a=e.color;return Object(c.jsxs)("div",{className:"tagPreview",children:[Object(c.jsx)("span",{className:"tagPreview__color",style:{backgroundColor:a}}),Object(c.jsxs)("h4",{children:[t,n>1?Object(c.jsxs)("span",{className:"lightest",children:[" ",n,"x"]}):""]})]})}var ie=function(e){var t=Object(r.useRef)(null);return Object(c.jsx)(z.a,{in:e.in,timeout:e.short?150:350,nodeRef:t,classNames:"fade",exit:e.exit,unmountOnExit:!0,children:Object(c.jsx)("span",{ref:t,children:e.children})})};function le(e){var t=e.preview,n=e.post,a=e.tags,r=Object.keys(a).length;return Object(c.jsx)(ie,{in:t,exit:!1,short:!0,children:Object(c.jsx)("div",{className:"popup__wrapper",children:Object(c.jsxs)("div",{className:"popup postPreview",children:[Object(c.jsx)("div",{className:"popup__header",children:Object(c.jsx)("h4",{className:"lightest",children:n.user.username})}),Object(c.jsxs)("div",{className:"popup__body",children:[Object(c.jsxs)("p",{style:{display:"inline"},children:[Object(c.jsxs)("span",{style:{textTransform:"capitalize"},children:[n.type,"\xa0"]}),"posted on ",n.date]}),function(){if(!n.tags)return null;if(0===n.tags.length)return Object(c.jsx)("p",{children:" without labels."});var e=r-2;return Object(c.jsx)("div",{className:"popup__tags",children:Object.entries(a).map((function(t,n){var a=Object(f.a)(t,2),r=a[0],s=a[1];return n<2?Object(c.jsx)(oe,{tag:r,count:s.length,color:s[0].color},r):2===n?Object(c.jsxs)("p",{children:["and ",e," more."]},r):null}))})}(n.tags.length)]})]})},n._id)})}var ue=function(e){var t=e.path,n=Object(b.a)(e,["path"]),a=Object(r.useState)(!1),s=Object(f.a)(a,2),o=s[0],i=s[1],l={position:"absolute",top:"".concat(n.y,"%")||!1,left:"".concat(n.x,"%")||!1};return t?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(le,{preview:o,tags:n.tags,post:n.post}),Object(c.jsx)("div",{style:l,children:Object(c.jsxs)("div",{style:{position:"relative"},children:[Object(c.jsx)("span",{className:"pin__color",style:{backgroundColor:n.color}}),Object(c.jsx)("div",{className:"pin pin__path",style:{position:"absolute",backgroundColor:n.color}})]})})]}):Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(le,{preview:o,tags:n.tags,post:n.post}),Object(c.jsx)("div",{className:"pin",onMouseEnter:function(){return i(!0)},onMouseLeave:function(){return i(!1)}})]})},de=n(46),je=n.n(de),be=function(e){var t=e.id,n=e.squeeze,a=se(),s=a.posts,o=a.loading,i=a.getLayerPosts;return Object(r.useEffect)((function(){function e(){return(e=Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i(t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),o?null:Object(c.jsx)("div",{className:"postCell",children:s&&s.map((function(e){return Object(c.jsx)(ie,{in:!n,children:Object(c.jsx)(ue,{post:e,tags:je()(e.tags,"tag")},e._id)})}))})},he=n(56),me=function(e){var t=e.expand,n=e.setExpand;return Object(c.jsx)("div",{className:"chevron ".concat(t&&"chevron--open"),onClick:function(){return n(!t)},children:"\u25e2"})},pe={fontFamily:"Graphik, sans-serif",lineHeight:"130%",textTransform:"uppercase",fontSize:"0.8rem",letterSpacing:"1px",fontWeight:"bold"},fe=n(74),Oe=function(e){var t=e.group,n=e.handleClick,a=e.disable,r=e.handleBlur,s=e.newName,o=e.handleChange,i=e.nodeRef;return Object(c.jsx)(c.Fragment,{children:a?Object(c.jsxs)(l.b,{to:"/group/".concat(t.slug),className:"dndHeader__label",children:[Object(c.jsxs)("h4",{style:pe,children:[Object(c.jsx)(fe.default,{l:"0.6rem",name:"mapGroupIcon"}),t.label]}),Object(c.jsx)(L.k,{className:"dndHeader__edit",onClick:n})]}):Object(c.jsx)("input",{type:"text",ref:i,className:"dndHeader__label dndHeader__label--edit",name:t.id,value:s,onChange:o,onBlur:r,style:pe})})},ge=function(e){var t=e.group;return Object(c.jsx)("div",{className:"dndHeader__label dndHeader__label--ungrouped",children:Object(c.jsx)("h4",{children:t.label})})},xe=n(26),ve=n.n(xe);var ye=function(e){var t=e.group,n=e.expand,a=e.setExpand,s=function(e){var t=Object(r.useContext)(d),n=t.user,a=t.groups,c=t.setGroups,s=n.house._id,o=Object(r.useState)(e.label),i=Object(f.a)(o,2),l=i[0],u=i[1],b=function(){var e=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.a.put("/houses/".concat(s),{groups:t}).then((function(e){c(t)})).catch((function(e){return console.log(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{newName:l,handleChange:function(e){u(e.currentTarget.value)},handleBlur:function(){var e=Object(F.a)(D.a.mark((function e(t){var n,c,r,s;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.currentTarget.name,c=Object(k.a)(a),r=a[n],s=ve()(l),r=Object(j.a)(Object(j.a)({},r),{},{label:l,slug:s}),c.splice(n,1,r),e.next=8,b(c);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}(t),o=s.handleBlur,i=s.newName,l=s.handleChange,u=function(e){var t=Object(r.useState)(e),n=Object(f.a)(t,2),a=n[0],c=n[1],s=Object(r.useRef)(null),o=function(e){s.current&&!s.current.contains(e.target)&&c(!0)};return Object(r.useEffect)((function(){return document.addEventListener("click",o,!0),function(){document.removeEventListener("click",o,!0)}})),{nodeRef:s,disable:a,setDisable:c}}(!0),b=u.disable,h=u.setDisable,m=u.nodeRef;return Object(c.jsxs)("div",{className:"dndHeader",children:["ungrouped"!==t.id?Object(c.jsx)(Oe,{group:t,disable:b,handleClick:function(e){e.preventDefault(),h(!1)},handleBlur:function(e){o(e),h(!0)},newName:i,handleChange:l,nodeRef:m}):Object(c.jsx)(ge,{group:t}),Object(c.jsx)(me,{expand:n,setExpand:a})]})},_e=function(e){var t=e.l,a=e.id,s=Object(b.a)(e,["l","id"]),o=function(e){return Object(r.lazy)((function(){return n(318)("./".concat(e)).catch((function(){return Promise.resolve().then(n.bind(null,74))}))}))}(a),i=s.strokeWidth||5,l=s.stroke||"currentColor",u=s.fill||"none";return Object(c.jsx)(r.Suspense,{fallback:Object(c.jsx)("span",{children:"..."}),children:Object(c.jsx)("svg",{width:t,height:t,viewBox:"-2.5 -2.5 105 105",className:"mapLayerIcon",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i,stroke:l,fill:u,xmlns:"http://www.w3.org/2000/svg",children:Object(c.jsx)(o,{})})})},Ce=function(e){var t=e.layer,n=e.group;return Object(c.jsx)(l.b,{to:"/".concat(t.slug),children:Object(c.jsxs)("p",{className:"dnd__item \n         ".concat("ungrouped"!==n.id?"dnd__item--nested":"","\n        "),children:[Object(c.jsx)(_e,{l:"0.8rem",id:"L".concat(t.id)}),t.label]})})},Ne=function(e){var t=e.listType,n=e.setHoverId,a=e.listId,r=e.group,s=e.layers;return Object(c.jsx)(he.c,{style:{transform:"none"},droppableId:a,type:t,direction:"vertical",isCombineEnabled:!1,children:function(e){return Object(c.jsxs)("div",Object(j.a)(Object(j.a)({className:"dnd__list"},e.droppableProps),{},{ref:e.innerRef,children:[s.map((function(e,t){return Object(c.jsx)(he.b,{draggableId:e.id,index:t,children:function(t){return Object(c.jsx)("div",Object(j.a)(Object(j.a)(Object(j.a)({},t.dragHandleProps),t.draggableProps),{},{ref:t.innerRef,children:Object(c.jsx)(Ce,{layer:e,group:r,setHoverId:n})}))}},e.id)})),e.placeholder]}))}})};function we(e){var t=e.group,n=e.deleteRow;return Object(c.jsx)("button",{className:"group__delete",children:"ungrouped"!==t.id&&Object(c.jsx)(L.i,{onClick:function(){return n(t)}})})}var ke=function(e){var t=Object(r.useRef)(null),n=e.group,a=Object(r.useState)(!0),s=Object(f.a)(a,2),o=s[0],i=s[1];return Object(c.jsxs)("div",{className:"group",children:[Object(c.jsx)(we,Object(j.a)({},e)),Object(c.jsxs)("div",{className:"group__body",children:[Object(c.jsx)(ye,{group:n,expand:o,setExpand:i}),Object(c.jsx)(z.a,{in:o,timeout:350,classNames:"grow",nodeRef:t,unmountOnExit:!0,children:Object(c.jsx)("div",{style:{transformOrigin:"top"},ref:t,children:Object(c.jsx)(Ne,Object(j.a)({},e))})})]})]})},Ee=function(e){var t=e.handleClick;return Object(c.jsx)(C,{name:"+ add group",kind:"ghost",handleClick:t})},De=["#4E94D2","#67c3ec","#C8E2FD","#70C7DB","#ACC1D2","#D8D9DE","#D0EEF0","#7aa9b9","#c5c9d2","#8BC2E0","#A9D1D9","#AED3DC","#B1D4CE","#B8C4DA","#BBD2F4","#A3E3FF","#BFCEE5"],Fe=["#b39f86","#E6DDCE","#cc634e","#E7C4A8","#D68A58","#DAC5B2","#D2BFB8","#eed1c1","#DEBB9F","#FCCBA0"],Se=["#E3D2DA","#DCBFC1","#E5D5D8","#A993AA","#d7b9c3","#e1a4ac","#cecdc9","#9FA3AF","#D8BBCD","#98A5D2","#DC8DCE","#c59f9c","#DDD8D5","#D5B7AF"],Te=["#FF533F","#D27F57","#FE786D","#fa6954","#7CD054","#86A28C","#CECEC6","#4FE454","#ccdbc8","#a1d7ca"],Be=["#FA6219","#F4DD73","#EEAD35","#F3E2C2","#EACA3B","#FF8532","#FAE1C3"],Ae=["#FFAF00","#FBF0D2","#F1D292","#DBA65A","#E5C32C","#f0a065","#FECB00","#FFB047","#f0da9e"],Re=["#7DB078","#96D85D","#C9E7DF","#95CB99","#dde182","#90b39d","#9EEA86","#afc5ae","#a0b9b6","#6ed4c7","#3ACB4A","#ABC5A2","#659B5D"];function Le(e){var t=Object(r.useContext)(d),n=t.user,c=t.setGroups,s=n.house._id,o=Object(r.useState)(null),i=Object(f.a)(o,2),l=i[0],u=i[1];Object(r.useEffect)((function(){u(e)}),[e]);var b=function(){var e=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.a.put("/houses/".concat(s),{groups:t}).then((function(e){console.log(e),c(t)})).catch((function(e){return console.log(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(F.a)(D.a.mark((function e(t){var n,a,c,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=l.filter((function(e){return e.id!==t.id})),t.layers.length?(c=l[l.length-1].layers,r=[].concat(Object(k.a)(c),Object(k.a)(t.layers)),n=a.map((function(e){return"ungrouped"===e.id?Object(j.a)(Object(j.a)({},e),{},{layers:r}):e}))):n=a,e.next=4,b(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{groups:l,reorderRows:function(e,t,n){var c,r=e.find((function(e){return e.id===t.droppableId})),s=e.find((function(e){return e.id===n.droppableId}));if(t.droppableId===n.droppableId){var o=function(e,t,n){var a=e.splice(t,1),c=Object(f.a)(a,1)[0];return e.splice(n,0,c),e}(r.layers,t.index,n.index);return c=e.map((function(e){return e.id===s.id?Object(j.a)(Object(j.a)({},e),{},{layers:o}):e})),b(c)}var i=function(e,t){console.log(t);var n=a[t];console.log(n);var c=n.length,r=n[Math.floor(Math.random()*Math.floor(c))];return e.color=r,console.log(r),e}(r.layers[t.index],s.zone);r.layers.splice(t.index,1),s.layers.splice(n.index,0,i),c=e.map((function(e){return t.droppableId===e.id?r:n.droppableId===e.id?s:e})),b(c)},addRow:function(e){var t=l[l.length-1];l.splice(l.length-1,1);var n={id:"".concat(l.length),label:"Group ".concat(l.length+1),slug:"group-".concat(l.length+1),zone:"clay",layers:[]},a=[].concat(Object(k.a)(l),[n,t]);b(a)},deleteRow:h}}var Ie=function(e){return Object(c.jsx)(M.a,{mode:"out-in",children:Object(c.jsx)(z.a,{timeout:350,classNames:"rollOutX",addEndListener:function(e,t){e.addEventListener("transitionend",t,!1)},children:e.children},e.state)})},Pe=function(e){var t=Le(e.groupArray),n=t.groups,a=t.rows,s=t.reorderRows,o=t.addRow,i=t.deleteRow,l=Object(r.useState)(!1),u=Object(f.a)(l,2),d=u[0],b=u[1];return Object(c.jsx)(Ie,{state:d,children:Object(c.jsx)("div",{className:"dnd__wrapper",children:d?Object(c.jsx)(L.e,{className:"icon icon__btn expandX",onClick:function(){return b(!1)}}):Object(c.jsxs)(he.a,{onDragEnd:function(e){var t=e.destination,a=e.source;t&&s(n,a,t)},children:[Object(c.jsxs)("div",{className:"dnd__header",children:[Object(c.jsx)(Ee,{handleClick:function(){return o(a)}}),Object(c.jsx)(L.f,{className:"icon icon__btn expandX",onClick:function(){return b(!0)}})]}),Object(c.jsx)("div",{className:"dnd",children:n&&n.map((function(t){return Object(c.jsx)(ke,Object(j.a)({internalScroll:!0,listId:t.id,listType:"CARD",group:t,layers:t.layers,deleteRow:i},e),t.id)}))})]})})})};function Ke(){var e=function(){var e=Object(r.useContext)(d).user,t=Object(r.useState)(null),n=Object(f.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)([]),o=Object(f.a)(s,2),i=o[0],l=o[1];return Object(r.useEffect)((function(){var t=e.house.house,n=e.house.boarders.map((function(e){return B.a.get("/users/".concat(e)).then((function(e){return e.data.data.doc.username})).catch((function(e){return console.log(e)}))}));Promise.all(n).then((function(e){return l(e)})),c(t)}),[e]),{house:a,boarders:i}}(),t=e.house,n=e.boarders;return Object(c.jsx)("div",{className:"houseLegend",children:n&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("div",{className:"popup__header",children:Object(c.jsx)("h4",{className:"lightest",children:t})}),n.map((function(e){return Object(c.jsxs)("h4",{className:"light popup__item",children:["@",e]},e)}))]})})}var Me=function(e){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"map__key",children:[Object(c.jsx)(Ke,{}),Object(c.jsx)(Pe,{groupArray:e.groups,hoverId:e.hoverId,setHoverId:e.setHoverId})]}),Object(c.jsx)("div",{className:"map__canvas",children:e.groups.map((function(t,n){return Object(c.jsxs)("div",{className:"groupGrid",children:[Object(c.jsx)(re,{slug:t.slug,label:t.label,p:"1rem",heavy:!0}),Object(c.jsx)(ce,{columns:"repeat(3, minmax(0, 1fr))",gap:1.5,children:t.layers.map((function(t){return Object(c.jsxs)("div",{className:"groupGrid__cell",children:[Object(c.jsx)(re,{slug:"".concat(t.slug),label:t.label}),Object(c.jsx)(be,{id:t.id,squeeze:e.squeeze})]},t.slug)}))})]},n)}))})]})},ze=function(e){var t=e.items;return Object(c.jsx)(c.Fragment,{children:t&&t.length>0?t.map((function(e){return Object(c.jsx)("div",{className:"drawer__item",children:Object(c.jsxs)("div",{className:"tagPreview",children:[Object(c.jsx)("span",{className:"tagPreview__color",style:{backgroundColor:e.color}}),Object(c.jsx)("h4",{children:e.tag})]})},e._id)})):Object(c.jsx)("p",{className:"fullWidth flex justifyCenter",children:"No paths yet"})})},Ue=function(e){var t=Object(r.useState)(!1),n=Object(f.a)(t,2),a=n[0],s=n[1];return Object(c.jsx)(Ie,{state:a,children:Object(c.jsxs)("div",{className:"slide",children:[a?Object(c.jsx)(L.e,{className:"icon icon__btn expandX",onClick:function(){return s(!1)}}):Object(c.jsx)(L.f,{className:"icon icon__btn expandX",onClick:function(){return s(!0)}}),a?null:Object(c.jsxs)(c.Fragment,{children:[" ",e.children]})]})})};var He=function(e){var t=e.posts,n=e.color,a=e.squeeze,s=Object(r.useRef)(null),o=function(){var e=Object(r.useRef)(null),t=Object(r.useState)(null),n=Object(f.a)(t,2),a=n[0],s=n[1];return{cellRef:e,getPinPos:function(){var e=Object(F.a)(D.a.mark((function e(t,n){var a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.length&&(a=t.map((function(e){var t=50*Math.random(),a=2*Math.PI*Math.random(),r=Math.round(t*Math.cos(a)+50),s=Math.round(t*Math.sin(a)+50);return Object(c.jsx)(ue,{post:e,tags:je()(e.tags,"tag"),x:r,y:s,color:n,path:!0},e._id)})),s(a));case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),pins:a}}(),i=o.getPinPos,l=o.pins;return Object(r.useEffect)((function(){i(t,n)}),[]),t?Object(c.jsx)("div",{className:"pathCell--posts",ref:s,style:{height:a?"5vw":"".concat(10*t.length,"vw")},children:Object(c.jsx)(ie,{in:!a,children:l&&l})}):null},Ge=function(e){var t=e.path,n=e.squeeze,a=se(),s=a.posts,o=a.getPathPosts,i=a.loading;return Object(r.useEffect)((function(){function e(){return(e=Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o(t._id);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),i?null:Object(c.jsx)("div",{className:"pathCell",children:Object(c.jsx)(He,{posts:s,color:t.color,squeeze:n})})},qe=function(e){var t=e.paths,n=e.squeeze;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"map__key",children:[Object(c.jsx)(Ke,{}),Object(c.jsx)(Ue,{children:Object(c.jsx)(ze,{items:t})})]}),Object(c.jsx)("div",{className:"map__canvas",children:Object(c.jsx)(ce,{columns:"repeat(3, 1fr)",autoRows:"auto",gap:1.5,children:t.map((function(e){return Object(c.jsxs)("div",{className:"groupGrid__cell",children:[Object(c.jsx)(re,{label:e.tag,slug:"/path/".concat(ve()(e.tag))}),Object(c.jsx)(Ge,{path:e,squeeze:n})]},e._id)}))})})]})};function We(e){return Object(c.jsx)("button",{type:"button",className:"btn ".concat(e.active?"active":""),onClick:e.handleClick,"data-id":e.dataId,children:e.icon})}function Ze(e){var t=e.direction,n=e.button,a=e.tooltips,r=e.getTooltip,s=e.hideTooltip;return Object(c.jsxs)("div",{className:"tooltipWrapper tooltipWrapper--".concat(t),"data-id":n.id,"data-label":n.name,onMouseEnter:r,onMouseLeave:s,onClick:e.handleClick,children:[Object(c.jsx)("button",{type:"button",className:"btn",children:n.icon}),Object(c.jsx)(Ve,{tooltip:n.name,id:n.id,show:a[n.id]||!1,direction:t})]})}function Ve(e){var t=e.tooltip,n=e.show,a=e.direction,r={column:{top:"50%",transform:"translate(4rem, -50%)"},row:{left:"50%",transform:"translate(-50%, -5rem)"}};return Object(c.jsx)(c.Fragment,{children:n&&Object(c.jsx)("div",{className:"tltp",style:"column"===a?r.column:r.row,children:Object(c.jsx)("h4",{children:t})})})}function Xe(e){var t=Object(r.useState)([]),n=Object(f.a)(t,2),a=n[0],c=n[1],s=e.map((function(e){return!1})),o=function(){c(s)};Object(r.useEffect)((function(){o()}),[e]);return{tooltips:a,getTooltip:function(e){var t=e.currentTarget.dataset.id;s[t]=!s[t],c(s)},hideTooltip:o}}var Je=function(e){var t=e.buttons,n=e.direction,a=e.zoomIn,r=e.setZoom,s=Xe(t),o=s.tooltips,i=s.getTooltip,u=s.hideTooltip;return Object(c.jsxs)("div",{className:"nav__wrapper",children:[a?Object(c.jsx)(We,{icon:te.icon,dataId:te.dataId,handleClick:function(){return r(!a)}}):Object(c.jsx)(We,{icon:ee.icon,dataId:ee.dataId,handleClick:function(){return r(!a)}}),Object(c.jsxs)("nav",{className:"btnbarWrapper ".concat(n),children:[t.map((function(t,a){return Object(c.jsx)(l.c,{to:"/".concat(t.url),className:"navBtn--".concat(n),children:Object(c.jsx)(Ze,Object(j.a)({button:t,tooltips:o,getTooltip:i,hideTooltip:u},e))},t.id)})),e.squeezeBtn.map((function(t,n){return Object(c.jsx)(Ze,Object(j.a)({button:t,tooltips:o,getTooltip:i,hideTooltip:u,handleClick:e.handleExpandClick},e),t.id)}))]})]})};var Ye=function(e){return Object(c.jsx)(M.a,{mode:"out-in",children:Object(c.jsx)(z.a,{timeout:350,classNames:"fade",addEndListener:function(e,t){e.addEventListener("transitionend",t,!1)},children:e.children},e.state)})};function $e(e){var t;return t=e.squeeze?"2px":"6px",Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"flex column",children:[Object(c.jsx)("d",{is:"dot",style:{margin:t}}),Object(c.jsx)("d",{is:"dot",style:{margin:t}})]}),Object(c.jsxs)("div",{className:"flex column",children:[Object(c.jsx)("d",{is:"dot",style:{margin:t}}),Object(c.jsx)("d",{is:"dot",style:{margin:t}})]})]})}function Qe(){var e=Object(r.useContext)(d),t=e.groups,n=e.globalTags;!function(){var e=Object(r.useContext)(d),t=e.groups,n=e.setRooms;Object(r.useEffect)((function(){var e=t.map((function(e){return e.layers}));n(e.flat())}),[t])}();var a=Object(r.useState)(!0),s=Object(f.a)(a,2),o=s[0],i=s[1],l=function(){var e=Object(r.useState)(!1),t=Object(f.a)(e,2),n=t[0],a=t[1];return{squeeze:n,squeezeBtn:[{id:4,name:"squeeze",type:"bottom",icon:Object(c.jsx)($e,{className:"icon icon__btn",squeeze:n,"data-id":"squeeze"})}],handleSqueeze:function(){a(!n)}}}(),u=l.squeeze,j=l.squeezeBtn,b=l.handleSqueeze;return Object(c.jsxs)("div",{className:"page",children:[Object(c.jsx)(ae,{}),Object(c.jsxs)("div",{className:"map",children:[Object(c.jsx)("div",{className:"map__nav",children:Object(c.jsx)(Je,{buttons:Z,squeezeBtn:j,direction:"row",handleExpandClick:b,squeeze:u,zoomIn:o,setZoom:i})}),Object(c.jsx)(Ye,{state:o,children:o?Object(c.jsx)(Me,{groups:t,squeeze:u}):Object(c.jsx)(qe,{paths:n,squeeze:u})})]})]})}var et=n(11);var tt=n(75),nt=n.n(tt);function at(e){var t=Object(r.useRef)(null);return Object(r.useEffect)((function(){nt()(t.current)}),[]),Object(c.jsx)("textarea",{className:"input input--white inlineComment",name:"comment",placeholder:"Comment...",ref:t,contentEditable:!0,suppressContentEditableWarning:!0,onChange:e.handleChange,value:e.comment,onKeyDown:e.handleKeyDown})}function ct(e){var t=e.comment,n=e.deleteComment,a=Object(r.useContext)(d).user,s=Object(r.useState)(""),o=Object(f.a)(s,2),i=o[0],l=o[1],u=Object(r.useState)(!1),j=Object(f.a)(u,2),b=j[0],h=j[1];return Object(r.useEffect)((function(){t.user.username?l(t.user.username):l(a.username)}),[a,t]),Object(r.useEffect)((function(){if(a.username===i)return h(!0)}),[i,a]),Object(c.jsxs)("div",{className:"comment",children:[Object(c.jsxs)("div",{className:"comment__body",children:[Object(c.jsx)("div",{className:"comment__X",children:b&&Object(c.jsx)(L.i,{"data-id":t._id,className:"icon icon__btn icon--small",onClick:function(e){return n(e)}})}),Object(c.jsx)("h4",{className:"comment__text",children:t.comment})]}),Object(c.jsx)("h6",{className:"comment__author",children:i})]})}function rt(e){var t=e.postComments,n=e.deleteComment;return Object(c.jsx)(c.Fragment,{children:t&&0!==t.length?Object(c.jsxs)("div",{className:"commentList",children:[Object(c.jsx)("h4",{className:"lightest",children:"comments"}),t.map((function(e){return Object(c.jsx)(ct,{comment:e,deleteComment:n},e._id)}))]}):Object(c.jsx)("h4",{className:"lightest",children:"no comments"})})}var st=function(e){var t=e.tags;return 0!==Object.keys(t).length?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h4",{className:"lightest",children:"tags"}),Object.entries(t).map((function(e){var t=Object(f.a)(e,2),n=t[0],a=t[1];return Object(c.jsx)(oe,{tag:n,count:a.length,color:a[0].color},n)}))]}):Object(c.jsx)("h4",{className:"lightest",children:"no tags"})};function ot(e){var t=e.post,n=e.tags,a=e.handleDeleteDetail,s=function(e){var t=Object(r.useContext)(d).user,n=Object(r.useReducer)((function(e,t){switch(t.type){case"getComments":return Object(j.a)(Object(j.a)({},e),{},{postComments:t.c});case"writeComment":return Object(j.a)(Object(j.a)({},e),{},{comment:t.comment});case"addComment":return Object(j.a)(Object(j.a)({},e),{},{postComments:e.postComments.concat(t.newComment)});case"deleteComment":return Object(j.a)(Object(j.a)({},e),{},{postComments:e.postComments.filter((function(e){return e._id!==t.id}))});default:return e}}),{postComments:[],comment:""}),a=Object(f.a)(n,2),c=a[0],s=a[1];return Object(r.useEffect)((function(){function t(){return(t=Object(F.a)(D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.a.get("/comments/".concat(e)).then((function(e){var t=e.data.data.comments;s({type:"getComments",c:t})})).catch((function(e){return console.log(e)}));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e]),{data:c,handleChange:function(e){s({type:"writeComment",comment:e.target.value})},handleKeyDown:function(n){13===n.keyCode&&""!==n.target.value&&B.a.post("/comments",{post:e,user:t,comment:n.target.value}).then((function(e){var t=e.data.data.doc;s({type:"addComment",newComment:t}),s({type:"writeComment",comment:""})}))},deleteComment:function(e){var t=e.currentTarget.dataset.id;B.a.delete("/comments/".concat(t)).then((function(){s({type:"deleteComment",id:t})})).catch((function(e){return console.log(e)}))}}}(t._id),o=s.data,i=s.handleKeyDown,l=s.handleChange,u=s.deleteComment;return Object(c.jsxs)("div",{className:"edit__sidebar",children:[Object(c.jsxs)("div",{className:"edit__metadata",children:[Object(c.jsx)("h4",{className:"lightest",children:"created by"}),Object(c.jsx)("h4",{className:"light",children:t.user.username})]}),Object(c.jsxs)("div",{className:"edit__metadata",children:[Object(c.jsx)("h4",{className:"lightest",children:"created on"}),Object(c.jsx)("h4",{className:"light",children:t.date})]}),Object(c.jsx)("div",{className:"edit__metadata",children:Object(c.jsx)(st,{tags:n})}),Object(c.jsx)("div",{className:"edit__metadata",children:Object(c.jsx)(rt,{postComments:o.postComments,deleteComment:u})}),Object(c.jsx)(at,{handleChange:l,handleKeyDown:i,comment:o.comment}),Object(c.jsx)(L.x,{className:"icon icon__btn icon--warning editPost__trash","data-id":t._id,onClick:a})]})}var it=n(76),lt=function(e){var t=e.link;return Object(c.jsx)("div",{className:"linkCard",children:Object(c.jsx)(it.ReactTinyLink,{showGraphic:!1,width:"10vw",url:t,header:"",description:"",minLine:0})})},ut=function(e){var t=e.link;return Object(c.jsx)(it.ReactTinyLink,{cardSize:"small",showGraphic:!0,maxLine:4,minLine:1,url:t})},dt=function(e){var t=e.link;return Object(c.jsx)(it.ReactTinyLink,{cardSize:"large",showGraphic:!0,maxLine:2,minLine:1,url:t})};function jt(){var e,t=Object(r.useContext)(d).globalTags;t&&t.length>0&&(e=t.map((function(e){return e.tag})));var n=s.a.createRef(),a=Object(r.useState)(!0),o=Object(f.a)(a,2),i=o[0],l=o[1],u=Object(r.useState)(et.EditorState.createEmpty()),j=Object(f.a)(u,2),b=j[0],h=j[1],m=function(e){h(e)};Object(r.useEffect)((function(){i||n.current.focus()}),[i]);var p=function(){var n=Object(F.a)(D.a.mark((function n(a){var r,s,o,i,l,u,d;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=Object(et.convertFromRaw)(JSON.parse(a.content)),!e){n.next=12;break}return o=function(e,t,n){l(i,e,t)},i=new RegExp(e.join("|"),"gi"),l=function(e,t,n){for(var a,c,r=t.getText();null!==(a=e.exec(r));)n(c=a.index,c+a[0].length)},u=function(e){var n=e.decoratedText.toLowerCase(),a=t.find((function(e){return e.tag===n})).color;return Object(c.jsx)("span",{className:"editorTag",style:{backgroundColor:a},children:e.children})},d=new et.CompositeDecorator([{strategy:o,component:u}]),s=et.EditorState.createWithContent(r,d),n.abrupt("return",h(s));case 12:return console.log("no tags"),s=et.EditorState.createWithContent(r),n.abrupt("return",h(s));case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return{tags:t,displayNoteBody:p,editorState:b,setEditorState:h,onNoteChange:m,editNote:function(){l(!i)},isReadOnly:i,handleKeyCommand:function(e,t){var n=et.RichUtils.handleKeyCommand(t,e);return n?(m(n),"handled"):"not-handled"},mapKeyToEditorCommand:function(e){if(9!==e.keyCode)return Object(et.getDefaultKeyBinding)(e);e.preventDefault();var t=et.RichUtils.onTab(e,b,4);t!==b&&m(t)},toggleInlineStyle:function(e){e.preventDefault();var t=e.currentTarget.dataset.id;m(et.RichUtils.toggleInlineStyle(b,t))},toggleBlockType:function(e){e.preventDefault();var t=e.currentTarget.dataset.id;m(et.RichUtils.toggleBlockType(b,t))},setFocus:function(){n.current.focus()},editRef:n}}function bt(e){var t=e.items,n=e.active,a=e.selectItem,s=Object(r.useRef)(null),o=t.filter((function(e){return e.label!==n})),i=Object(r.useState)(!1),l=Object(f.a)(i,2),u=l[0],d=l[1];return Object(c.jsxs)("div",{className:"selectmenu",children:[Object(c.jsxs)("h4",{className:"selectmenu__picked",onClick:function(){return d(!u)},children:[n,Object(c.jsx)(L.h,{className:"icon icon__btn selectmenu__expand"})]}),Object(c.jsx)(z.a,{in:u,timeout:700,nodeRef:s,classNames:"rollDown",unmountOnExit:!0,children:Object(c.jsx)("menu",{className:"selectmenu__dropdown",ref:s,children:o.map((function(e){return Object(c.jsx)("li",{className:"selectmenu__item","data-id":e.id,onClick:function(e){return a(e)},children:e.label},e.id)}))})})]})}function ht(e){var t=e.buttons,n=e.direction,a=Xe(t),r=a.tooltips,s=a.getTooltip,o=a.hideTooltip;return Object(c.jsx)("menu",{className:"btnbarWrapper ".concat(n),children:t.map((function(t){return Object(c.jsx)(Ze,Object(j.a)({button:t,tooltips:r,getTooltip:s,hideTooltip:o,handleClick:e.handleClick},e),t.id)}))})}function mt(e){var t=e.editorState.getCurrentInlineStyle(),n=e.editorState.getSelection(),a=e.editorState.getCurrentContent().getBlockForKey(n.getStartKey()).getType(),r=function(t){t.preventDefault(),e.toggleBlockType(t)};return Object(c.jsxs)("div",{className:"toolbar ".concat(e.styled?"toolbar--styled":""),children:[J.map((function(n){return Object(c.jsx)("div",{"data-id":n.style,onMouseDown:function(t){t.preventDefault(),e.onToggleInline(t)},children:Object(c.jsx)(We,{icon:n.icon,active:t.has(n.style),dataId:n.style},n.label)},n.style)})),$.map((function(e){return Object(c.jsx)("div",{"data-id":e.style,onMouseDown:r,children:Object(c.jsx)(We,{icon:e.icon,active:e.style===a,dataId:e.style})},e.style)})),Object(c.jsx)(bt,{items:X,active:"header"===a.substring(0,6)?a:"paragraph",selectItem:r}),e.addTag&&Object(c.jsx)("div",{onMouseDown:function(t){t.preventDefault(),e.addTagFromNote(t)},children:Object(c.jsx)(ht,{handleClick:e.addTagFromNote,buttons:Y,direction:"solo"})})]})}var pt=["100%","25%","5%"],ft={fontFamily:"Work Sans, sans-serif",fontSize:"1.5rem",fontWeight:300,letterSpacing:"0.5px"},Ot=function(e){return e=e.substr(0,e.lastIndexOf("/"))};function gt(){var e=Object(u.g)(),t=Object(u.h)(),n=function(){var e=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.delete("/posts/".concat(t)).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function a(){return(a=Object(F.a)(D.a.mark((function a(c){var r;return D.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n(c.currentTarget.dataset.id);case 2:r=Ot(t.pathname),e.push(r);case 4:case"end":return a.stop()}}),a)})))).apply(this,arguments)}return{openPost:function(n){var a=n.currentTarget.dataset.id;e.push("".concat(t.pathname,"/").concat(a))},updatePost:function(){var e=Object(F.a)(D.a.mark((function e(t,n){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.put("/posts/".concat(n),{content:t}).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),deletePost:n,handleDeleteDetail:function(e){return a.apply(this,arguments)}}}function xt(e){var t=e.openPost,n=Object(r.useRef)(null),a=Object(u.i)(),s=Object(u.h)(),o=function(e){var t=Object(r.useState)(null),n=Object(f.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(null),o=Object(f.a)(s,2),i=o[0],l=o[1],u=Object(r.useState)(!0),d=Object(f.a)(u,2),j=d[0],b=d[1];return{post:a,tags:i,loading:j,getPostDetail:function(){var t=Object(F.a)(D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",B.a.get("/posts/".concat(e)).then((function(e){var t=e.data.data.doc;c(t),l(je()(t.tags,"tag")),b(!1)})).catch((function(e){return console.log(e)})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}(a.postId),i=o.post,d=o.tags,j=o.loading,b=o.getPostDetail;Object(r.useEffect)((function(){b()}),[a.postId]);var h=jt(),m=h.displayNoteBody,p=h.editorState,O=h.setEditorState,g=h.onNoteChange,x=h.editNote,v=h.isReadOnly,y=h.handleKeyCommand,_=h.mapKeyToEditorCommand,C=h.toggleInlineStyle,N=h.toggleBlockType,w=h.setFocus,k=h.editRef,E=gt(),S=E.updatePost,T=E.handleDeleteDetail;function A(){return(A=Object(F.a)(D.a.mark((function e(){var t,n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.getCurrentContent(),n=JSON.stringify(Object(et.convertToRaw)(t)),x(),e.next=5,S(n,i._id);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){i&&"note"===i.type&&m(i)}),[i]),j?null:Object(c.jsx)("div",{className:"modal__background",children:Object(c.jsxs)("div",{className:"edit",children:[Object(c.jsx)(l.b,{to:Ot(s.pathname),children:Object(c.jsxs)("div",{className:"modal__X",onClick:t,children:[" ",Object(c.jsx)(L.i,{className:"icon icon__btn"})]})}),Object(c.jsxs)("div",{className:"edit__content",children:[Object(c.jsx)(ot,{post:i,tags:d,handleDeleteDetail:T}),Object(c.jsxs)("div",{className:"editPost",children:[Object(c.jsxs)("div",{className:"editPost__header",children:[Object(c.jsx)(z.a,{in:!v,timeout:350,nodeRef:n,classNames:"fade",unmountOnExit:!0,children:Object(c.jsx)("span",{ref:n,children:Object(c.jsx)(mt,{editorState:p,onToggleInline:C,toggleBlockType:N,setFocus:w,addTag:!1})})}),Object(c.jsx)(L.k,{className:"icon icon__btn editPost__pen ".concat(v?"":"icon--active"),onClick:x})]}),"note"===i.type?Object(c.jsx)("div",{className:"editPost__noteDetail ".concat(v?"":"active"),children:Object(c.jsx)(et.Editor,{readOnly:v,editorState:p,ref:k,setEditorState:O,handleKeyCommand:y,mapKeyToEditorCommand:_,onChange:g})}):Object(c.jsx)("div",{className:"editPost__linkDetail",children:Object(c.jsx)(dt,{link:i.content})}),Object(c.jsx)("div",{className:"editPost__save ".concat(v?"":"active"),children:Object(c.jsx)(W,{name:"save changes",handleClick:function(){return A.apply(this,arguments)}})}),Object(c.jsx)("div",{})]})]})]})})}function vt(e){var t=e.value,n=e.handleClickIn,a=e.handleBlur,s=e.handleChange,o=Object(r.useRef)(null);return Object(r.useEffect)((function(){nt()(o.current)}),[]),Object(c.jsx)("textarea",{type:"text",ref:o,className:"inlineEdit inlineText light",name:"description",value:t,onClick:n,onBlur:a,onChange:s,rows:1})}function yt(e){var t=e.style,n=e.value,a=e.size,r=e.handleClickIn,s=e.handleBlur,o=e.handleChange;return Object(c.jsx)("input",{type:"text",className:"inlineEdit",name:"name",value:n,disabled:!1,size:a,style:t,onClick:r,onBlur:s,onChange:o})}var _t=s.a.forwardRef((function(e,t){var n=function(e){var t=Object(u.g)(),n=Object(r.useContext)(d),a=n.setGroups,c=n.groups,s=n.user.house._id,o=function(){var e=Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.push("/");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.a.get("/houses/".concat(s)).then((function(e){var t=e.data.data.doc.groups;a(t)})).catch((function(e){return console.log(e)})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(F.a)(D.a.mark((function e(t){var n,a,r,o;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Object(k.a)(c),c.forEach((function(e){e.layers.forEach((function(a){a.id===t&&(n=e)}))})),r=n.layers.filter((function(e){return e.id!==t})),o=a.map((function(e){return e.id===n.id?Object(j.a)(Object(j.a)({},e),{},{layers:r}):e})),e.abrupt("return",B.a.put("/houses/".concat(s),{groups:o}).catch((function(e){return console.log(e)})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.delete("/posts/h/".concat(s,"/").concat(t)).catch((function(e){return console.log(e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{handleDeleteLayer:function(){var t=Object(F.a)(D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l(e);case 2:return t.next=4,b(e);case 4:return t.next=6,i();case 6:return t.next=8,o();case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}(e.page.id).handleDeleteLayer,a=function(e){var t=Object(u.g)(),n=Object(r.useContext)(d),a=n.user,c=n.setGroups,s=a.house._id,o=a.house.groups,i=function(){var e=Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.push("/");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.a.put("/houses/".concat(s),{groups:t}).then((function(e){console.log(e),c(t)})).catch((function(e){return console.log(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(F.a)(D.a.mark((function e(t){var n,a,c,r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=o.filter((function(e){return e.id!==t.id})),!t.layers.length){e.next=8;break}return c=o[o.length-1].layers,r=[].concat(Object(k.a)(c),Object(k.a)(t.layers)),n=a.map((function(e){return"ungrouped"===e.id?Object(j.a)(Object(j.a)({},e),{},{layers:r}):e})),e.abrupt("return",n);case 8:return n=a,e.abrupt("return",n);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function h(){return(h=Object(F.a)(D.a.mark((function t(){var n;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b(e);case 2:return n=t.sent,t.next=5,l(n);case 5:return t.next=7,i();case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return{handleDeleteGroup:function(){return h.apply(this,arguments)}}}(e.page).handleDeleteGroup,s=e.layer;return Object(c.jsx)("div",{className:"modal__background",onClick:function(t){return e.handleOutsideClick(t)},children:Object(c.jsxs)("div",{className:"modal",ref:t,children:[Object(c.jsxs)("div",{className:"modal__X",onClick:e.toggleModal,children:[" ",Object(c.jsx)(L.i,{className:"icon icon__btn"})," "]}),Object(c.jsxs)("div",{className:"modal__content",children:[Object(c.jsxs)("h3",{children:["Delete ",s?"layer":"group"]}),Object(c.jsxs)("p",{style:{paddingTop:"1rem"},children:["Confirm you'd like to delete this ",s?"layer":"group",".",s?" Any posts in this layer will also be deleted.":"All layers in this group will become ungrouped. The layers, and the posts in them, will not be deleted."]}),Object(c.jsxs)("div",{className:"modal__actions",children:[Object(c.jsx)(C,{name:"cancel",kind:"secondary",handleClick:e.toggleModal}),Object(c.jsx)(C,{name:"delete",color:"warning",handleClick:s?n:a})]})]})]})})}));function Ct(){var e=Object(r.useState)(!1),t=Object(f.a)(e,2),n=t[0],a=t[1],c=s.a.createRef();return{toggleModal:function(){a(!n)},handleOutsideClick:function(e){c.current&&!c.current.contains(e.target)&&a(!1)},modal:n,modalRef:c}}function Nt(e){var t=function(e){var t=e.page,n=t.label,a=t.id,c={name:n,description:t.description},s=Object(u.g)(),o=Object(r.useContext)(d),i=o.user,l=o.groups,b=o.setGroups,h=i.house._id,m=Object(r.useState)(!1),p=Object(f.a)(m,2),O=p[0],g=p[1],x=Object(r.useState)(c||{}),v=Object(f.a)(x,2),y=v[0],_=v[1],C=Object(r.useState)(n.length+1),N=Object(f.a)(C,2),w=N[0],E=N[1],T=function(){var e=Object(F.a)(D.a.mark((function e(t){var n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.name,e.next=3,R(n,A);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(e){s.push("/".concat(e),{from:e})},R=function(){var e=Object(F.a)(D.a.mark((function e(t,n){var c,r,s,o,i,u,d,m;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g(!1),c=y.name,r=y.description,s=ve()(y.name),l.forEach((function(e){e.layers.forEach((function(e){e.id===a&&(o=e)}))})),o={label:c,slug:s,description:r,id:o.id},u=Object(k.a)(l),l.forEach((function(e){e.layers.forEach((function(t){t.id===a&&(i=e)}))})),d=i.layers.map((function(e){return e.id===a?o:e})),m=u.map((function(e){return e.id===i.id?Object(j.a)(Object(j.a)({},e),{},{layers:d}):e})),e.next=12,B.a.put("/houses/".concat(h),{groups:m}).then((function(e){if(b(m),"name"===t)return n(s)})).catch((function(e){return console.log(e)}));case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return{editInline:O,values:y,size:w,handleClickIn:function(){g(!0)},handleBlur:T,handleChange:function(e){var t=e.target.name,n=e.target.value;_(Object(j.a)(Object(j.a)({},y),{},Object(S.a)({},t,n))),"name"===t&&E(n.length+1)}}}(e),n=t.values,a=t.size,s=t.handleClickIn,o=t.handleBlur,i=t.handleChange,l=Ct(),b=l.modal,h=l.toggleModal,m=l.handleOutsideClick,p=l.modalRef;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"page__info",children:[Object(c.jsxs)("div",{className:"page__title",children:[Object(c.jsx)(yt,{style:ft,value:n.name,size:a,handleClickIn:s,handleBlur:o,handleChange:i}),Object(c.jsx)(vt,{value:n.description,handleClickIn:s,handleBlur:o,handleChange:i})]}),Object(c.jsx)("div",{className:"page__delete",children:Object(c.jsx)(L.x,{className:"icon icon__btn icon--warning",onClick:h})})]}),b&&Object(c.jsx)(_t,{toggleModal:h,handleOutsideClick:m,ref:p,page:e.page,layer:e.layer})]})}function wt(e){var t=Object(r.useState)(e),n=Object(f.a)(t,2),a=n[0],c=n[1];return{handleOneFilter:function(e){c(e.currentTarget.dataset.id)},activeItem:a}}var kt=function(e){var t=e.room;return t?Object(c.jsx)("span",{className:"fixedBtn",children:Object(c.jsx)(l.b,{to:{pathname:"/add",state:{id:t.id,label:t.label,slug:t.slug}},children:Object(c.jsx)(We,{icon:Object(c.jsx)(L.a,{className:"icon icon__btn"})})})}):null};function Et(e){var t=e.list,n=e.title,a=e.activeItem,r=e.handleOneFilter;return Object(c.jsxs)("menu",{children:[Object(c.jsx)("h4",{className:"listmenu__title",children:n}),t.map((function(e){return Object(c.jsx)("li",{className:"listmenu__item ".concat(a===e?"active":""),"data-id":e,onClick:function(e){return r(e)},children:e},e)}))]})}var Dt=function(e){var t=e.item,n=e.id;return Object(c.jsx)("li",{className:"listmenu__item ".concat(e.active&&"active"),"data-id":n,children:t.label})};function Ft(e){return Object(c.jsxs)("menu",{children:[Object(c.jsx)("h4",{className:"listmenu__title",children:e.title}),e.list.map((function(e,t){return Object(c.jsx)(Dt,{item:e,id:t},t)}))]})}var St=function(e){return Object(c.jsxs)("div",{className:"layer__sidebar",children:[e.group&&Object(c.jsx)(Ft,{title:"layers",list:e.group.layers}),Object(c.jsx)(Et,{title:"zoom",list:pt,handleOneFilter:e.setZoomFilter,activeItem:e.activeView})]})},Tt=function(e){var t=e.type;return Object(c.jsx)("div",{className:"layer__empty",children:Object(c.jsxs)("h3",{className:"light",children:["Empty ",t]})})},Bt=function(e){var t=e.type;return Object(c.jsx)("div",{className:"layer__empty--sub",children:Object(c.jsxs)("h4",{className:"lightest",children:["Empty ",t]})})},At=Object(r.forwardRef)((function(e,t){var n=Object(r.useRef)(null),a=e.items,s=e.selectItem,o=e.childData,i=e.show,l=e.revertAll,u=e.roundTop;return Object(c.jsx)(z.a,{in:i,timeout:350,nodeRef:n,classNames:"fade",unmountOnExit:!0,children:Object(c.jsx)("span",{ref:n,children:Object(c.jsx)("menu",{className:"basicselect",ref:t,children:a.map((function(e){return Object(c.jsx)("li",{className:"selectmenu__item \n                                ".concat(u?"selectmenu__item--top":""),"data-label":e,"data-id":o,onClick:function(e){l(),s(e)},children:e},e)}))})})})})),Rt=function(e){var t=e.tag,n=e.handleHover,a=e.handleStopHover,r=e.tagpath,s=Object(b.a)(e,["tag","handleHover","handleStopHover","tagpath"]);return Object(c.jsx)("div",{className:"post100__tag",children:Object(c.jsx)("h4",{className:"tag","data-index":s.post._id,"data-id":t._id,onMouseEnter:n,onMouseLeave:a,style:r&&r===t._id?{backgroundColor:t.color,color:"#31302C",cursor:"pointer"}:{},children:t.tag})})},Lt=function(e){var t=e.editorState,n=e.setEditorState,a=e.onNoteChange,s=Object(r.useRef)(null);return Object(c.jsx)("div",{className:"post100__body__note",children:Object(c.jsx)(et.Editor,{readOnly:!0,editorState:t,ref:s,setEditorState:n,onChange:a})})};function It(e){var t,n=e.post,a=e.toggleMenu,s=e.menu,o=e.i,i=e.toggleRef,u=e.revertAll,d=e.handleDeletePost,b=e.openPost,h=(t=n.tags,Array.from(new Set(t.map((function(e){return e.tag})))).map((function(e){return t.find((function(t){return t.tag===e}))}))),m=jt(),p=m.displayNoteBody,f=m.editorState,O=m.setEditorState,g=m.onNoteChange;Object(r.useEffect)((function(){return"note"===n.type&&p(n),null}),[n]);return Object(c.jsx)(c.Fragment,{children:Object(c.jsxs)("div",{className:"post100",children:[Object(c.jsxs)("div",{className:"post100__header",children:[Object(c.jsx)("h4",{className:"lightest",children:n.user.username}),Object(c.jsxs)("div",{className:"post100__header__edit",children:[Object(c.jsx)("h4",{className:"lightest",children:n.date}),Object(c.jsx)(L.l,{className:"icon icon__btn post100__editBtn","data-id":o,onClick:a}),Object(c.jsx)("div",{className:"post100__header__editMenu",children:Object(c.jsx)(At,{items:["open","delete"],toggleMenu:a,show:s[o],selectItem:function(e){switch(e.currentTarget.dataset.label){case"delete":d(e);break;case"open":b(e);break;default:return null}},childData:n._id,revertAll:u,roundTop:!0,ref:i})})]})]}),Object(c.jsx)("div",{className:"post100__body",children:"note"===n.type?Object(c.jsx)(Lt,{editorState:f,onNoteChange:g,setEditorState:O}):Object(c.jsx)("div",{className:"post__body__link",children:Object(c.jsx)(ut,{link:n.content})})}),0!==n.tags.length&&Object(c.jsxs)("div",{className:"post100__tags",children:[Object(c.jsx)("h4",{className:"tag",style:{paddingLeft:0},children:"paths:"}),h.map((function(t,n){return Object(c.jsx)(l.b,{to:"/path/".concat(t.slug),children:Object(c.jsx)(Rt,Object(j.a)({tag:t},e),n)})}))]})]})})}function Pt(e){var t=e.activeView,n=e.posts,a=Object(r.useRef)(null),s=function(e){var t=Object(r.useRef)(null),n=Object(r.useState)([]),a=Object(f.a)(n,2),c=a[0],s=a[1],o=function(){var t=e.map((function(e){return!1}));s(t)};Object(r.useEffect)((function(){o()}),[e]);var i=function(e){t.current&&!t.current.contains(e.target)&&o()};return Object(r.useEffect)((function(){return document.addEventListener("click",i,!0),function(){document.removeEventListener("click",i,!0)}})),{revertAll:o,toggleMenu:function(e){var t=e.currentTarget.dataset.id,n=Object(k.a)(c);n[t]=!n[t],s(n)},toggleRef:t,menu:c}}(n),o=s.toggleMenu,i=s.toggleRef,l=s.menu,u=s.revertAll;return Object(c.jsx)(z.a,{in:"100%"===t,timeout:250,nodeRef:a,classNames:"zoomIn",unmountOnExit:!0,exit:!1,children:Object(c.jsx)("div",{className:"postRow100",ref:a,children:e.posts.map((function(t,n){return Object(c.jsx)(It,Object(j.a)({post:t,toggleMenu:o,menu:l,i:n,revertAll:u,toggleRef:i},e),t._id)}))})})}function Kt(e){var t=e.post,n=e.openPost,a=Object(u.h)(),s=Object(r.useRef)(null),o=jt(),i=o.displayNoteBody,d=o.editorState,j=o.setEditorState,b=o.onNoteChange;return Object(r.useEffect)((function(){"note"===t.type&&i(t)}),[t]),Object(c.jsxs)("div",{className:"post25__wrapper",children:[Object(c.jsx)("h4",{className:"post25__user",children:t.user.username}),Object(c.jsxs)("div",{className:"post25","data-id":t._id,children:[Object(c.jsx)("div",{className:"post25__header",children:Object(c.jsx)(L.l,{className:"icon icon__btn"})}),Object(c.jsx)(l.b,{to:{pathname:"".concat(a.pathname,"/").concat(t._id),state:{post:t}},onClick:function(e){return n(e)},className:"post25__body","data-id":t._id,children:"note"===t.type?Object(c.jsxs)("div",{className:"post25__body__note",children:[Object(c.jsx)(et.Editor,{readOnly:!0,editorState:d,ref:s,setEditorState:j,onChange:b}),Object(c.jsx)("span",{className:"post25__body__fade"})]}):Object(c.jsx)("div",{className:"post25__body__link",children:Object(c.jsx)(lt,{link:t.content})})})]},t._id)]})}function Mt(e){var t=e.activeView,n=Object(r.useRef)(null),a=e.posts.length,s=Object(k.a)(Array(Math.ceil(a/4))).map((function(t,n){return e.posts.slice(4*n,4*n+4)}));return Object(c.jsx)(z.a,{in:"25%"===t,timeout:250,nodeRef:n,classNames:"zoom",unmountOnExit:!0,exit:!1,children:Object(c.jsx)("div",{className:"postRow25__container",ref:n,children:s.map((function(t,n){return Object(c.jsx)("div",{className:"postRow25",children:t.map((function(t,n){return Object(c.jsx)(Kt,{post:t,openPost:e.openPost},n)}))},n)}))})})}var zt=function(e){return console.log(e),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(Pt,Object(j.a)({},e)),Object(c.jsx)(Mt,Object(j.a)({},e))]})},Ut=Object(r.forwardRef)((function(e,t){var n=e.tagDetails,a=e.loadModal,r=e.postExcerpts,s=n.tag,o=n.date,i=n.tagCount;return Object(c.jsx)("div",{className:"pathLegend__container",ref:t,children:!a&&Object(c.jsxs)("div",{className:"popup pathLegend",children:[Object(c.jsxs)("div",{className:"pathLegend__body",children:[Object(c.jsxs)("div",{className:"popup__header pathLegend__header",children:[Object(c.jsx)("span",{className:"tagPreview__color",style:{backgroundColor:s.color}}),Object(c.jsx)("h4",{children:s.tag})]}),Object(c.jsxs)("h5",{className:"light",children:["This path has been used ",i,1===i?" time ":" times ","since it was created on ",o,"."]}),Object(c.jsx)("div",{children:null!==r[0]&&r.map((function(e,t){return Object(c.jsxs)("h5",{className:"pathLegend__excerpt",children:["...",e,".."]},t)}))})]}),Object(c.jsx)("span",{className:"pathLegend__fade"})]})})}));function Ht(){var e=Object(r.useContext)(d).user,t=Object(r.useRef)(null),n=Object(r.useState)(!0),a=Object(f.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)([]),i=Object(f.a)(o,2),l=i[0],u=i[1],j=Object(r.useState)({tag:"",date:"",tagCount:"",postCount:""}),b=Object(f.a)(j,2),h=b[0],m=b[1],p=function(){var t=Object(F.a)(D.a.mark((function t(n){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B.a.get("/posts/details/".concat(e.house._id,"/").concat(n)).then((function(e){var t=e.data.data,n=t.tag,a=t.posts,c=t.postCount,r=t.tagCount,o=new Date(n[0].createdOn);o=o.toDateString("en",{day:"numeric",month:"short",year:"numeric"}),m({tag:n[0],date:o,tagCount:r,postCount:c});var i=a.filter((function(e){return"note"===e.type})).map((function(e){for(var t,a=n[0].tag,c=Object(et.convertFromRaw)(JSON.parse(e.content)),r=new RegExp("[^.!?;]*(".concat(a,")[^.?!;]*[.?!;]"),"i"),s=c.getPlainText();null!==(t=r.exec(s));)return t[0];return null}));u(i),s(!1)})).catch((function(e){return console.log(e)}));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),O=Object(r.useState)(null),g=Object(f.a)(O,2),x=g[0],v=g[1],y=Object(r.useState)({lengthX:"",heightY:"",postId:""}),_=Object(f.a)(y,2),C=_[0],N=_[1];return{tagRef:t,handleHover:function(e){var n=e.currentTarget.dataset.id,a=e.currentTarget.dataset.index;p(n),function(e,n,a){var c=e.currentTarget.getBoundingClientRect().right,r=(t.current.getBoundingClientRect().left+t.current.getBoundingClientRect().right)/2-c,s=t.current.getBoundingClientRect().top,o=(e.currentTarget.getBoundingClientRect().top+e.currentTarget.getBoundingClientRect().bottom)/2;N({lengthX:r,heightY:o-s,postId:n}),v(a)}(e,a,n)},handleStopHover:function(){s(!0),v(null)},tagDetails:h,postExcerpts:l,loadModal:c,tagpath:x,setTagpath:v,coords:C}}var Gt=function(e){var t=Object(u.i)(),n=se(),a=n.posts,s=n.loading,o=n.getLayerPosts,i=n.getPathPosts,l=Ht(),d=l.tagpath,b=l.coords,m=l.handleHover,p=l.handleStopHover,f=l.tagRef,O=l.tagDetails,g=l.postExcerpts,x=l.loadModal,v=gt(),y=v.openPost,_=v.deletePost;function C(){return(C=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(t.target.dataset.id);case 2:return e.next=4,o();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){return e.path?i(e.path._id):o(e.layer.id)}),[t]),s?Object(c.jsx)(h,{}):a.length?Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(zt,Object(j.a)({handleDeletePost:function(e){return C.apply(this,arguments)},openPost:y,posts:a,handleHover:m,handleStopHover:p,coords:b,tagpath:d},e)),Object(c.jsx)(Ut,{ref:f,tagpath:d,tagDetails:O,loadModal:x,postExcerpts:g})]}):Object(c.jsx)(c.Fragment,{children:e.subpage?Object(c.jsx)(Bt,{type:"layer"}):Object(c.jsx)(Tt,{type:"layer"})})};function qt(){var e=Object(u.i)(),t=wt("date"),n=t.handleOneFilter,a=t.activeItem,s=Object(r.useState)("100%"),o=Object(f.a)(s,2),i=o[0],l=o[1],j=function(){var e=Object(r.useContext)(d).groups,t=Object(r.useState)(!0),n=Object(f.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(null),o=Object(f.a)(s,2),i=o[0],l=o[1];function u(){return(u=Object(F.a)(D.a.mark((function t(n){var a;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.forEach((function(e){e.layers.forEach((function(e){e.slug===n&&(a=e)}))})),l(a),c(!1);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return{layer:i,loading:a,getLayer:function(e){return u.apply(this,arguments)}}}(),b=j.layer,h=j.loading,p=j.getLayer;Object(r.useEffect)((function(){p(e.room)}),[e]);var O=Ht().handleStopHover;return h?Object(c.jsx)(m,{}):Object(c.jsx)(c.Fragment,{children:b&&Object(c.jsxs)("div",{className:"page",onScroll:O,children:[Object(c.jsx)(ae,{nav:[{name:b.label,url:e.room}]}),Object(c.jsx)(Nt,{page:b,layer:!0}),Object(c.jsxs)("div",{className:"layer",children:[Object(c.jsx)(St,{setZoomFilter:function(e){return l(e.currentTarget.dataset.id)},handleOneFilter:n,activeItem:a}),Object(c.jsx)("div",{className:"layer__body",children:Object(c.jsx)(Gt,{activeView:i,layer:b})}),Object(c.jsx)(kt,{room:b})]})]})})}var Wt=function(){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(u.d,{children:Object(c.jsx)(u.b,{path:"/:room/:postId",component:xt})}),Object(c.jsx)(qt,{})]})};var Zt=function(e){var t=e.layer,n=e.activeView,a=Object(r.useRef)(null),s=Object(r.useState)(!0),o=Object(f.a)(s,2),i=o[0],u=o[1];return Object(c.jsxs)("div",{className:"sublayer",children:[Object(c.jsxs)("div",{className:"sublayer__header",children:[Object(c.jsx)(l.b,{to:"/".concat(t.slug),children:Object(c.jsx)("h3",{className:"sublayer__title",children:t.label})}),Object(c.jsx)(me,{expand:i,setExpand:u})]}),Object(c.jsx)(z.a,{in:i,timeout:350,classNames:"grow",nodeRef:a,unmountOnExit:!0,children:Object(c.jsx)("div",{style:{transformOrigin:"top"},ref:a,children:Object(c.jsx)("div",{className:"sublayer__body",children:Object(c.jsx)(Gt,{layer:t,activeView:n,subpage:!0})})})})]},t.id)},Vt=function(){var e=Object(u.i)(),t=Object(r.useState)("100%"),n=Object(f.a)(t,2),a=n[0],s=(n[1],function(e){var t=Object(r.useContext)(d).user.house._id,n=Object(r.useState)(null),a=Object(f.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)(null),i=Object(f.a)(o,2),l=i[0],u=i[1],b=Object(r.useState)(!0),h=Object(f.a)(b,2),m=h[0],p=h[1];function O(){return g.apply(this,arguments)}function g(){return(g=Object(F.a)(D.a.mark((function n(){return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",B.a.get("/houses/".concat(t)).then((function(t){var n=t.data.data.doc.groups.find((function(t){return t.slug===e}));s(n),p(!1)})).catch((function(e){return console.log(e)})));case 1:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var x=function(){var e=Object(F.a)(D.a.mark((function e(n,a){var c;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=n.map((function(e){return B.a.get("/posts/h/".concat(t,"/").concat(e.id)).then((function(t){return t.data.data.results.map((function(t){return Object(j.a)(Object(j.a)({},t),{},{slug:e.slug,layer:e.label,color:e.color,zone:a})}))})).catch((function(e){return console.log(e)}))})),Promise.all(c).then((function(e){return u(e.flat())}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();function v(){return(v=Object(F.a)(D.a.mark((function e(){var t;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O();case 2:return t=e.sent,e.next=5,x(t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{loading:m,group:c,posts:l,handleGetGroup:function(){return v.apply(this,arguments)},getGroup:O,getGroupPosts:x}}(e.group)),o=s.group,i=s.loading,l=s.getGroup;return Object(r.useEffect)((function(){l()}),[e.group]),i?Object(c.jsx)(m,{}):Object(c.jsx)(c.Fragment,{children:o&&Object(c.jsxs)("div",{className:"page",children:[Object(c.jsx)(ae,{}),Object(c.jsx)(Nt,{page:o,layer:!1}),Object(c.jsx)(kt,{room:o.layers[0]}),Object(c.jsxs)("div",{className:"layer",children:[Object(c.jsx)(St,{group:o}),Object(c.jsx)("div",{className:"layer__body",children:o.layers&&o.layers.map((function(e,t){return Object(c.jsx)(Zt,{layer:e,activeView:a},t)}))})]})]})})},Xt=function(){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(u.d,{children:Object(c.jsx)(u.b,{path:"/group/:group/:postId",component:xt})}),Object(c.jsx)(Vt,{})]})};function Jt(e){var t=e.notif;return Object(c.jsx)("div",{className:"notification success",children:Object(c.jsx)("h5",{children:t})})}var Yt=s.a.forwardRef((function(e,t){return Object(c.jsx)("div",{className:"modal__background",onClick:function(t){return e.handleOutsideClick(t)},children:Object(c.jsxs)("div",{className:"modal",ref:t,children:[Object(c.jsxs)("div",{className:"modal__X",onClick:e.toggleModal,children:[" ",Object(c.jsx)(L.i,{className:"icon icon__btn"})," "]}),Object(c.jsxs)("div",{className:"modal__content",children:[Object(c.jsx)("h3",{children:"Delete account"}),Object(c.jsxs)("p",{style:{paddingTop:"1rem"},children:["Confirm you'd like to delete your user account and all data. ",Object(c.jsx)("b",{children:"This action can't be undone."})]}),Object(c.jsxs)("div",{className:"modal__actions",children:[Object(c.jsx)(C,{name:"cancel",kind:"secondary",handleClick:e.toggleModal}),Object(c.jsx)(C,{name:"delete",color:"warning",handleClick:e.deleteUser})]})]})]})})}));function $t(){var e,t=Object(r.useContext)(d).user,n=Ct(),a=n.modal,s=n.toggleModal,o=n.handleOutsideClick,i=n.modalRef,l=function(e){var t=Object(u.g)();return{deleteUser:function(){var n=Object(F.a)(D.a.mark((function n(){return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,B()({method:"DELETE",url:"users/".concat(e)}).then((function(e){console.log(e),t.push("/")}));case 3:n.next=8;break;case 5:n.prev=5,n.t0=n.catch(0),console.log(n.t0);case 8:case"end":return n.stop()}}),n,null,[[0,5]])})));return function(){return n.apply(this,arguments)}}()}}(t._id).deleteUser,j=A({initialValues:{form:"user",email:t.email,username:t.username,password:"",passwordConfirm:""}}),b=j.values,h=j.handleChange,m=j.handleSubmit,p=j.error,f=j.success;e=p?p.fields:[];var O=null==p&&null!==f;return Object(c.jsxs)("div",{className:"page",children:[Object(c.jsx)(ae,{}),Object(c.jsxs)("div",{className:"inlineForm",children:[Object(c.jsxs)("h3",{style:{marginBottom:"1rem"},children:["@",t.username]}),Object(c.jsxs)("div",{className:"inlineForm__notif",children:[p&&Object(c.jsx)(N,{error:p.messages}),O&&Object(c.jsx)(Jt,{notif:f})]}),Object(c.jsx)("div",{className:"flex justifyStart",style:{padding:"1rem 0"},children:Object(c.jsx)(w,{prompt:"Edit your account information"})}),Object(c.jsxs)("form",{onSubmit:m,children:[Object(c.jsx)(_,{values:b,handleChange:h,handleSubmit:m,user:t,invalidFields:e}),Object(c.jsx)("div",{className:"inlineForm__submit padBottomThree",style:{justifyContent:"flex-end"},children:Object(c.jsx)(C,{name:"save",kind:"primary",type:"submit"})})]}),Object(c.jsx)("div",{className:"flex justifyEnd pointer",children:Object(c.jsx)(w,{prompt:"Delete account",type:"light",handleClick:function(){return s()}})})]}),a&&Object(c.jsx)(Yt,{toggleModal:s,handleOutsideClick:o,ref:i,deleteUser:l})]})}function Qt(e){var t=e.items,n=e.tab,a=Object(r.useRef)(null),s=Object(r.useState)(!1),o=Object(f.a)(s,2),i=o[0],l=o[1];return Object(c.jsxs)("div",{className:"drawer",children:[Object(c.jsx)("h4",{className:"drawer__tab",onClick:function(){return l(!i)},children:n}),Object(c.jsx)(z.a,{in:i,timeout:350,nodeRef:a,classNames:"openDrawer",unmountOnExit:!0,children:Object(c.jsx)("menu",{className:"drawer__dropdown",ref:a,children:t&&t.length>0?t.map((function(e){return Object(c.jsx)("div",{className:"drawer__item",children:Object(c.jsxs)("div",{className:"tagPreview",children:[Object(c.jsx)("span",{className:"tagPreview__color",style:{backgroundColor:e.color}}),Object(c.jsx)("h4",{children:e.tag})]})},e._id)})):Object(c.jsx)("p",{className:"fullWidth flex justifyCenter",children:"No paths yet"})})})]})}function en(e){var t=e.values,n=e.handleChange;return Object(c.jsx)("div",{className:"upload upload--link",children:Object(c.jsx)(x,{type:"url",placeholder:"\ud83d\udcce",white:!0,name:"content",value:t.content,handleChange:n})})}var tn=Object(r.forwardRef)((function(e,t){var n=e.editorState,a=e.onNoteChange,s=e.mapKeyToEditorCommand,o=e.setFocus,i=e.handleKeyCommand,l=e.toggleInlineStyle,u=e.toggleBlockType,d=e.addTagFromNote,j=Object(r.useState)(!1),b=Object(f.a)(j,2),h=b[0],m=b[1],p=Object(r.useRef)(null);return Object(r.useEffect)((function(){m(!0)}),[h]),Object(r.useEffect)((function(){h&&o()}),[h]),Object(c.jsxs)("span",{style:{position:"relative"},children:[Object(c.jsx)(mt,{editorState:n,onToggleInline:l,toggleBlockType:u,setFocus:o,addTagFromNote:d,addTag:!0,styled:!0}),Object(c.jsx)(z.a,{in:h,timeout:350,nodeRef:p,classNames:"rollDown",unmountOnExit:!0,children:Object(c.jsx)("div",{className:"editorWrapper editorWrapper--block",ref:p,onClick:o,children:Object(c.jsx)(et.Editor,{editorState:n,ref:t,spellCheck:!0,onChange:a,handleKeyCommand:i,mapKeyToEditorCommand:s})})})]})}));function nn(){var e=function(){var e=Object(r.useReducer)((function(e,t){switch(t.type){case"AddToDropZone":return Object(j.a)(Object(j.a)({},e),{},{inDropZone:t.inDropZone});case"AddFile":return Object(j.a)(Object(j.a)({},e),{},{file:t.upload});case"AddMessage":return Object(j.a)(Object(j.a)({},e),{},{message:t.msg});default:return e}}),{inDropZone:!1,uploadComplete:!1,file:"",message:""}),t=Object(f.a)(e,2),n=t[0],a=t[1],c=["image/jpg","image/png","image/svg+xml","image/gif","application/pdf"];return{handleDragEnter:function(e){e.preventDefault(),a({type:"AddToDropZone",inDropZone:!0})},handleDragLeave:function(e){e.preventDefault(),a({type:"AddToDropZone",inDropZone:!1})},handleDragOver:function(e){e.preventDefault(),e.dataTransfer.dropEffect="move",a({type:"AddToDropZone",inDropZone:!0})},handleDrop:function(e){e.preventDefault();var t,n=Object(k.a)(e.dataTransfer.files),r=n[0].type;n&&(c.includes(r)?(t=n[0].name,console.log(t),a({type:"AddFile",upload:n})):t="Only images and PDFs are supported.",a({type:"AddToDropZone",inDropZone:!1}),a({type:"AddMessage",msg:t}))},data:n,dispatch:a}}(),t=e.handleDragEnter,n=e.handleDragLeave,a=e.handleDragOver,s=e.handleDrop,o=e.data;return Object(c.jsx)("div",{className:"drag ".concat(o.inDropZone?"drag--active":""),onDragOver:function(e){return a(e)},onDragEnter:function(e){return t(e)},onDragLeave:function(e){return n(e)},onDrop:function(e){return s(e)},children:o.message?Object(c.jsx)("h4",{children:o.message}):Object(c.jsx)("h4",{children:"drag or click"})})}function an(e){var t=e.show,n=e.value,a=e.handleChange,s=Object(r.useRef)(null);return Object(c.jsx)(z.a,{in:t,timeout:700,nodeRef:s,classNames:"rollDown",unmountOnExit:!0,children:Object(c.jsx)("textarea",{className:"input longInput",ref:s,name:"comment",value:n,onChange:a,contentEditable:!0,suppressContentEditableWarning:!0})})}function cn(e){var t=e.text,n=e.show,a=e.direction,s=e.type,o=Object(r.useRef)(null);return Object(c.jsx)(z.a,{in:n,timeout:150,nodeRef:o,classNames:"quickFade",unmountOnExit:!0,children:Object(c.jsx)("div",{ref:o,className:"tooltip tooltip--".concat(a," tooltip--").concat(s),"data-id":e.dataId,children:t})})}function rn(e){var t=e.results,n=e.selectTag;return Object(c.jsx)("ul",{className:"autocomplete",children:t?t.map((function(e){return Object(c.jsx)("li",{className:"autocomplete__item","data-id":e._id,"data-name":e.tag,onClick:n,children:Object(c.jsx)("h4",{children:e.tag})},e._id)})):Object(c.jsx)("div",{children:"No tags"})})}function sn(e){var t=e.tags,n=e.selectTag;return t?Object(c.jsxs)("div",{className:"recentTags",children:[Object(c.jsx)("h4",{className:"light",style:{marginRight:"1.5rem"},children:"Recently created"}),t.map((function(e){return Object(c.jsx)("h4",{className:"recentTags__tag","data-id":e._id,"data-name":e.tag,onClick:n,children:e.tag},e._id)}))]}):Object(c.jsx)("div",{children:"No recent tags"})}function on(e){var t=Object(r.useContext)(d),n=t.user,a=t.globalTags,c=Object(r.useState)(!0),s=Object(f.a)(c,2),o=s[0],i=s[1],l=Object(r.useState)(!0),u=Object(f.a)(l,2),j=u[0],b=u[1],h=Object(r.useState)(null),m=Object(f.a)(h,2),p=m[0],O=m[1],g=Object(r.useState)(null),x=Object(f.a)(g,2),v=x[0],y=x[1],_=Object(r.useState)({unique:"",sum:""}),C=Object(f.a)(_,2),N=C[0],w=C[1];Object(r.useEffect)((function(){var t;switch(e){case"recent":t="date";break;case"A - Z":t="name";break;case"count":t="count";break;default:t="date"}B.a.get("/posts/tags/".concat(n.house._id,"/").concat(t)).then((function(e){var t=e.data.data;O(t.allTags),w({unique:t.allTags.length,sum:t.postTagSum}),i(!1)})).catch((function(e){console.log(e)}))}),[e,a]);var k=Object(r.useState)(null),E=Object(f.a)(k,2),D=E[0],F=E[1];return Object(r.useEffect)((function(){try{B()({method:"GET",url:"/tags/last3/".concat(n.house._id)}).then((function(e){F(e.data.data.results)}))}catch(e){console.log(e)}}),[a]),{loading:o,t_loading:j,tags:p,tagCount:N,allTags:v,getAllTagsFromPosts:function(){B.a.get("/posts/allTags/".concat(n.house._id,"/")).then((function(e){var t=e.data.data;y(t.allTagsFromPosts),b(!1)})).catch((function(e){console.log(e)}))},lastThreeTags:D}}function ln(e){var t=Object(r.useRef)(null),n=e.type,a=e.room,s=e.switchType,o=e.values,i=e.error,u=Object(r.useState)(!1),d=Object(f.a)(u,2),b=d[0],h=d[1],m=Object(r.useState)(!1),p=Object(f.a)(m,2),O=p[0],g=p[1],x=on().lastThreeTags,v=0!==e.results.length&&""!==e.values.input;return Object(c.jsxs)("div",{className:"upload__container",children:[Object(c.jsxs)("div",{className:"upload__controller",children:[Object(c.jsx)(ht,{handleClick:s,type:n,buttons:V,direction:"column"}),Object(c.jsx)(l.b,{to:"/home/".concat(a),children:Object(c.jsx)(We,{icon:Object(c.jsx)(L.i,{className:"icon icon__btn icon--warning"})})})]}),Object(c.jsxs)("div",{className:"upload__form",children:[Object(c.jsx)(z.a,{in:o.error,timeout:350,nodeRef:t,classNames:"fade",unmountOnExit:!0,children:Object(c.jsxs)("div",{className:"upload__error__msg",ref:t,children:[" ",Object(c.jsx)(w,{type:"warning",prompt:o.error})]})}),Object(c.jsx)(z.a,{in:i,timeout:350,nodeRef:t,classNames:"fade",unmountOnExit:!0,children:Object(c.jsx)("div",{className:"upload__error__notif",ref:t,children:Object(c.jsx)(N,{error:i})})}),"link"===n&&Object(c.jsx)(en,Object(j.a)({},e)),"note"===n&&Object(c.jsx)(tn,Object(j.a)({ref:e.editRef},e)),"file"===n&&Object(c.jsx)(nn,{}),Object(c.jsxs)("div",{className:"upload__extra",style:{flexDirection:"column"},children:[("link"===n||"file"===n)&&Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("div",{className:"upload__label",children:Object(c.jsx)("h4",{children:"Add path"})}),Object(c.jsxs)("div",{className:"addTags",children:[Object(c.jsx)(K,{values:o,results:e.results,ref:e.searchRef,selectTag:e.selectTag,handleChange:e.handleChange,addTags:e.addTags,clearInput:e.clearInput,handleKeyDown:e.handleKeyDown}),v&&Object(c.jsx)(rn,{results:e.results,selectTag:e.selectTag}),Object(c.jsx)(I,{tags:o.tags,handleDelete:e.removeTag})]})," "]}),"note"===n&&Object(c.jsxs)("div",{className:"tooltipAnchor flex alignCenter",children:[Object(c.jsx)(L.t,{className:"icon icon__btn",onMouseEnter:function(){return g(!0)},onMouseLeave:function(){return g(!1)}}),Object(c.jsx)("h5",{className:"lightest",children:" \xa0 Add path "}),Object(c.jsx)(cn,{show:O,text:Object(c.jsx)(Q,{}),direction:"left",style:"black"})]}),Object(c.jsx)(sn,{tags:x,selectTag:e.selectTag})]}),Object(c.jsxs)("div",{className:"upload__extra",children:[Object(c.jsx)("div",{className:"upload__label active",onClick:function(){return h(!b)},children:Object(c.jsx)("h4",{children:"Comment"})}),Object(c.jsx)(an,{show:b,value:o.comment,handleChange:e.handleChange})]})]})]})}var un=function(e){var t=Object(r.useRef)(null);return Object(c.jsx)(z.a,{in:e.in,timeout:350,nodeRef:t,classNames:"rollDown",unmountOnExit:!0,children:Object(c.jsx)("div",{ref:t,children:e.children})})};function dn(e){var t=e.items,n=e.active,a=e.selectItem,s=e.setAdd,o=t.filter((function(e){return e.label!==n})),i=Object(r.useState)(!1),l=Object(f.a)(i,2),u=l[0],d=l[1];Object(r.useEffect)((function(){d(!1)}),[n]);return Object(c.jsxs)("div",{className:"selectmenu",children:[Object(c.jsxs)("h4",{className:"selectmenu__picked",onClick:function(){d(!u)},style:{paddingRight:"5rem"},children:[n,Object(c.jsx)(L.h,{className:"icon icon__btn selectmenu__expand"})]}),Object(c.jsx)(un,{in:u,children:Object(c.jsxs)("menu",{className:"selectmenu__dropdown",children:[o.map((function(e){return Object(c.jsx)("li",{className:"selectmenu__item","data-id":e.id,onClick:function(e){return a(e)},children:e.label},e.id)})),Object(c.jsx)("li",{className:"selectmenu__item selectmenu__item--new",onClick:function(){return s(!1)},children:Object(c.jsx)("h4",{className:"lightest",style:{fontWeight:"bold"},children:"+ Add layer"})})," ",Object(c.jsx)("div",{style:{height:"3rem",marginBottom:"-3rem",background:"transparent"}})]})})]})}function jn(e){var t=e.values,n=e.rooms,a=e.setAdd,s=e.editorState,o=function(){var e=Object(r.useContext)(d).globalTags,t=Object(u.g)(),n=Object(r.useState)(null),a=Object(f.a)(n,2),c=a[0],s=a[1];return{handleLinkSubmit:function(){var e=Object(F.a)(D.a.mark((function e(n){var a,c,r,o,i,l,u,d,j;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.values,c=a.content,r=a.user,o=a.house,i=a.room,l=a.roomName,u=a.tags,d=a.comment,j=ve()(l),e.next=4,B.a.post("/posts",{type:"link",content:c,user:r,house:o,room:i,tags:u}).then((function(e){var n=e.data.data.doc._id;""!==d&&B.a.post("/comments",{comment:d,user:r,post:n}),t.push("/".concat(j))})).catch((function(e){400===e.response.status&&s(e.response.data.messages)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),handleNoteSubmit:function(){var n=Object(F.a)(D.a.mark((function n(a,c){var r,s,o,i,l,u,d,j,b,h,m,p,f;return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=JSON.stringify(Object(et.convertToRaw)(c)),s=[],console.log(e),0!==e.length)for(i=c.getPlainText(),l=e.map((function(e){return e.tag})),u=new RegExp(l.join("|"),"gi"),d=function(){var t=o[0].toLowerCase(),n=e.find((function(e){return e.tag===t}));s.push(n)};null!==(o=u.exec(i));)d();return j=a.user,b=a.house,h=a.room,m=a.roomName,p=a.comment,f=ve()(m),n.prev=6,n.next=9,B()({method:"POST",url:"posts",data:{type:"note",content:r,user:j,house:b,room:h,tags:[].concat(s),comment:p}}).then((function(e){t.push("/".concat(f))}));case 9:n.next=14;break;case 11:n.prev=11,n.t0=n.catch(6),console.log(n.t0);case 14:case"end":return n.stop()}}),n,null,[[6,11]])})));return function(e,t){return n.apply(this,arguments)}}(),error:c}}(),i=o.handleLinkSubmit,l=o.handleNoteSubmit,b=o.error;return Object(c.jsxs)("form",{style:{width:"75%",marginTop:"3rem"},onSubmit:function(n){switch(n.preventDefault(),e.type){case"link":i({values:t});break;case"note":var a=s.getCurrentContent();l(t,a);break;default:i({values:t})}},children:[Object(c.jsxs)("div",{className:"addLayer",style:{justifyContent:"flex-end"},onClick:function(){return a(!1)},children:[Object(c.jsx)("h5",{className:"light",children:"Add layer"})," ",Object(c.jsx)(L.f,{className:"icon icon__btn"})]}),Object(c.jsx)(ln,Object(j.a)(Object(j.a)({},e),{},{error:b})),Object(c.jsxs)("div",{className:"inlineForm__submit",style:{justifyContent:"flex-end",paddingTop:"3rem"},children:[Object(c.jsxs)("div",{className:"flex alignCenter",children:[Object(c.jsx)("h4",{children:"Place in"}),Object(c.jsx)(dn,{items:n,active:t.roomName,selectItem:e.selectItem,setAdd:a})]}),Object(c.jsx)(C,{name:"add",kind:"primary",type:"submit"})]})]})}var bn=n(164),hn=n.n(bn);function mn(e){var t=Object(r.useContext)(d).rooms;console.log(t);var n=e.setAdd,a=function(){var e=Object(r.useContext)(d),t=e.user,n=e.groups,a=e.setGroups,c=t.house._id,s=Object(r.useState)(""),o=Object(f.a)(s,2),i=o[0],l=o[1],u=Object(r.useState)(null),b=Object(f.a)(u,2),h=b[0],m=b[1],p=Object(r.useState)(null),O=Object(f.a)(p,2),g=O[0],x=O[1],v=function(){var e=Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("/houses/".concat(c)).then((function(e){console.log(e.data.data.doc.groups)})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(F.a)(D.a.mark((function e(t){var a,c,r,s,o,i,l;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=ve()(t))&&""!==a){e.next=4;break}return m({messages:"Layer names can't be blank.",fields:["room"]}),e.abrupt("return");case 4:c=hn()(),r=Object(k.a)(n),s=r[r.length-1].layers,o={label:t,slug:a,description:"//",id:c},console.log(o),i=[].concat(Object(k.a)(s),[o]),l=r.map((function(e){return"ungrouped"===e.id?Object(j.a)(Object(j.a)({},e),{},{layers:i}):e})),_(l);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),_=function(){var e=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.a.put("/houses/".concat(c),{groups:t}).then(Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a(t),x("Layer created.");case 2:case"end":return e.stop()}}),e)})))).catch((function(e){return console.log(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return{handleChange:function(e){l(e.currentTarget.value)},handleAddRoom:function(){var e=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(t),m(null),x(null),e.next=5,y(i);case 5:return e.next=7,v();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),roomInput:i,error:h,success:g}}(),s=a.handleAddRoom,o=a.roomInput,i=a.handleChange,l=a.error,u=a.success;return Object(c.jsx)("div",{className:"page",onSubmit:s,style:{marginTop:"10rem"},children:Object(c.jsxs)("form",{style:{width:"75%"},children:[t.length>0&&Object(c.jsxs)("div",{className:"addLayer",onClick:function(){return n(!0)},children:[Object(c.jsx)(L.e,{className:"icon icon__btn icon--active"}),Object(c.jsx)("h5",{className:"light",children:"Back to post"})]}),Object(c.jsxs)("div",{className:"inlineForm__notif",children:[l&&Object(c.jsx)(N,{error:l.messages}),u&&Object(c.jsx)(Jt,{notif:u})]}),Object(c.jsxs)("div",{className:"upload__extra",children:[Object(c.jsx)("h4",{className:"upload__label",children:"Add layer"}),Object(c.jsx)(x,{type:"text",placeholder:"Layer name",name:"room",value:o,handleChange:i})]}),Object(c.jsx)("div",{className:"inlineForm__submit",style:{justifyContent:"flex-end"},children:Object(c.jsx)(C,{name:Object(c.jsx)(L.a,{}),kind:"primary",type:"submit"})})]})})}var pn=["#b39f86","#E6DDCE","#cc634e","#E7C4A8","#D68A58","#DAC5B2","#D2BFB8","#eed1c1","#DEBB9F","#FCCBA0","#FFD7BE","#FFBCB3","#FFB884","#F3E0DA","#F1ADAE","#FF7C74","#DDBC9D","#FCCBA0","#F7AE83","#F3B991","#E6A191","#fda985","#FF9F75","#FF533F","#D27F57","#FE786D","#fa6954","#FFAF00","#FBF0D2","#F1D292","#DBA65A","#E5C32C","#f0a065","#FECB00","#FFB047","#f0da9e","#FA6219","#F4DD73","#EEAD35","#F3E2C2","#EACA3B","#FF8532","#FAE1C3","#7DB078","#96D85D","#C9E7DF","#95CB99","#dde182","#90b39d","#9EEA86","#afc5ae","#a0b9b6","#6ed4c7","#3ACB4A","#ABC5A2","#659B5D","#7CD054","#86A28C","#CECEC6","#4FE454","#ccdbc8","#a1d7ca","#4E94D2","#67c3ec","#C8E2FD","#70C7DB","#ACC1D2","#D8D9DE","#D0EEF0","#7aa9b9","#c5c9d2","#8BC2E0","#A9D1D9","#AED3DC","#B1D4CE","#B8C4DA","#BBD2F4","#A3E3FF","#BFCEE5","#E3D2DA","#DCBFC1","#E5D5D8","#A993AA","#d7b9c3","#e1a4ac","#cecdc9","#9FA3AF","#D8BBCD","#98A5D2","#DC8DCE","#c59f9c","#DDD8D5","#D5B7AF"],fn=[{sand:["#b39f86","#E6DDCE","#cc634e","#E7C4A8","#D68A58","#DAC5B2","#D2BFB8","#eed1c1","#DEBB9F","#FCCBA0"]},{peach:["#FFD7BE","#FFBCB3","#FFB884","#F3E0DA","#F1ADAE","#FF7C74","#DDBC9D","#FCCBA0","#F7AE83","#F3B991","#E6A191","#fda985","#FF9F75"]},{red:["#FF533F","#D27F57","#FE786D","#fa6954"]},{yellow:["#FFAF00","#FBF0D2","#F1D292","#DBA65A","#E5C32C","#f0a065","#FECB00","#FFB047","#f0da9e","#FA6219","#F4DD73","#EEAD35","#F3E2C2","#EACA3B","#FF8532","#FAE1C3"]},{green:["#7DB078","#96D85D","#C9E7DF","#95CB99","#dde182","#90b39d","#9EEA86","#afc5ae","#a0b9b6","#6ed4c7","#3ACB4A","#ABC5A2","#659B5D","#7CD054","#86A28C","#CECEC6","#4FE454","#ccdbc8","#a1d7ca"]},{blue:["#4E94D2","#67c3ec","#C8E2FD","#70C7DB","#ACC1D2","#D8D9DE","#D0EEF0","#7aa9b9","#c5c9d2","#8BC2E0","#A9D1D9","#AED3DC","#B1D4CE","#B8C4DA","#BBD2F4","#A3E3FF","#BFCEE5"]},{purple:["#E3D2DA","#DCBFC1","#E5D5D8","#A993AA","#d7b9c3","#e1a4ac","#cecdc9","#9FA3AF","#D8BBCD","#98A5D2","#DC8DCE","#c59f9c","#DDD8D5","#D5B7AF"]}];function On(e){var t=Object(r.useContext)(d),n=t.user,a=t.rooms,o=t.globalTags,i=Object(r.useState)(!0),l=Object(f.a)(i,2),u=l[0],b=l[1],h=e.location.state||a[0],m=[{name:h.label,url:h.slug}],p=Object(r.useState)("note"),O=Object(f.a)(p,2),g=O[0],x=O[1],v=function(){var e=Object(r.useContext)(d).globalTags,t=e,n=s.a.createRef(),a=Object(r.useState)(et.EditorState.createEmpty()),o=Object(f.a)(a,2),i=o[0],l=o[1],u=function(e){l(e)};return Object(r.useEffect)((function(){var n=[];if(0!==e.length){n=t.map((function(e){return e.tag}));var a=new RegExp(n.join("|"),"gi"),r=function(e,t,n){for(var a,c,r=t.getText();null!==(a=e.exec(r));)n(c=a.index,c+a[0].length)},s=new et.CompositeDecorator([{strategy:function(e,t,n){r(a,e,t)},component:function(e){var n=e.decoratedText.toLowerCase(),a=t.find((function(e){return e.tag===n})).color;return Object(c.jsx)("span",{className:"editorTag",style:{backgroundColor:a},children:e.children})}}]),o=i.getCurrentContent(),u=et.EditorState.createWithContent(o,s);return l(u)}var d=i.getCurrentContent(),j=et.EditorState.createWithContent(d);l(j)}),[e]),{editorState:i,setEditorState:l,onNoteChange:u,handleKeyCommand:function(e,t){var n=et.RichUtils.handleKeyCommand(t,e);return n?(u(n),"handled"):"not-handled"},mapKeyToEditorCommand:function(e){if(9!==e.keyCode)return Object(et.getDefaultKeyBinding)(e);e.preventDefault();var t=et.RichUtils.onTab(e,i,4);t!==i&&u(t)},toggleInlineStyle:function(e){e.preventDefault();var t=e.currentTarget.dataset.id;u(et.RichUtils.toggleInlineStyle(i,t))},toggleBlockType:function(e){e.preventDefault();var t=e.currentTarget.dataset.id;u(et.RichUtils.toggleBlockType(i,t))},editRef:n,setFocus:function(){n.current.focus()}}}(),y=v.editorState,_=v.onNoteChange,C=v.mapKeyToEditorCommand,N=v.editRef,w=v.setFocus,E=v.handleKeyCommand,T=v.toggleInlineStyle,A=v.toggleBlockType,R=function(e){var t=e.initialValues,n=pn,a=Object(r.useContext)(d),c=a.user,o=a.globalTags,i=a.setGlobalTags,l=Object(r.useState)(t||{}),u=Object(f.a)(l,2),b=u[0],h=u[1],m=Object(r.useState)([]),p=Object(f.a)(m,2),O=p[0],g=p[1],x=o,v=s.a.createRef(),y=function(){var e=Object(F.a)(D.a.mark((function e(t){var a,r,s,o;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.trim(),r=ve()(a),s=Math.floor(Math.random()*Math.floor(n.length)),o=n[s],e.prev=4,e.next=7,B()({method:"POST",url:"tags",data:{tag:a,house:c.house,user:c._id,color:o,slug:r}}).then((function(e){if(200===e.status)return h(Object(j.a)(Object(j.a)({},b),{},{error:"This house already has that tag."}));var t=e.data.data.tag;h(Object(j.a)(Object(j.a)({},b),{},{tags:[].concat(Object(k.a)(b.tags),[t]),error:null,input:""})),i([].concat(Object(k.a)(x),[t]))}));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[4,9]])})));return function(t){return e.apply(this,arguments)}}(),_=function(){return b.input&&y(b.input),null};return{handleChange:function(e){var t=e.target.value,n=e.target.name;if(h(Object(j.a)(Object(j.a)({},b),{},Object(S.a)({},n,t))),v.current)try{B()({method:"GET",url:"search/".concat(c.house._id,"?search=").concat(t)}).then((function(e){var t=e.data.data.results;g(t)}))}catch(a){console.error(a)}},selectItem:function(e){h(Object(j.a)(Object(j.a)({},b),{},{roomName:e.currentTarget.textContent,room:e.currentTarget.dataset.id}))},values:b,results:O,searchRef:v,addTags:_,selectTag:function(e){var t=e.currentTarget.dataset.id;if(b.tags.map((function(e){return e._id})).includes(t))return h(Object(j.a)(Object(j.a)({},b),{},{error:"Don't add duplicate tags"}));B.a.get("tags/".concat(t)).then((function(e){var t=e.data.data.doc;h(Object(j.a)(Object(j.a)({},b),{},{tags:[].concat(Object(k.a)(b.tags),[t]),error:null,input:""}))}))},clearInput:function(){h(Object(j.a)(Object(j.a)({},b),{},{input:""}))},removeTag:function(e){var t=b.tags.filter((function(t){return t!==e}));h(Object(j.a)(Object(j.a)({},b),{},{tags:t}))},handleKeyDown:function(e){v.current&&(188!==e.keyCode&&13!==e.keyCode||(e.preventDefault(),_()))},addTagFromNote:function(e){var t=window.getSelection().toString();t&&y(t)}}}({initialValues:{content:"",input:"",tags:[],comment:"",house:n.house,user:n._id,room:h.id,roomName:h.label,error:null}}),L=R.values,I=R.handleChange,P=R.selectItem,K=R.searchRef,M=R.addTags,z=R.results,U=R.selectTag,H=R.clearInput,G=R.removeTag,q=R.handleKeyDown,W=R.addTagFromNote;return Object(c.jsxs)("div",{className:"page",children:[Object(c.jsx)(ae,{nav:m}),u?Object(c.jsx)(jn,{roomFrom:h,rooms:a,setAdd:b,type:g,switchType:function(e){x(e.currentTarget.dataset.label)},values:L,handleChange:I,selectItem:P,searchRef:K,addTags:M,results:z,selectTag:U,clearInput:H,removeTag:G,handleKeyDown:q,editorState:y,onNoteChange:_,mapKeyToEditorCommand:C,handleKeyCommand:E,toggleInlineStyle:T,toggleBlockType:A,editRef:N,setFocus:w,addTagFromNote:W}):Object(c.jsx)(mn,{setAdd:b}),Object(c.jsx)("span",{className:"fixedTab",children:Object(c.jsx)(Qt,{items:o,tab:"house paths"})})]})}var gn=function(e){var t=e.setEditor,n=e.showEdit;return Object(c.jsxs)("div",{className:"thread__header",children:[Object(c.jsxs)(l.b,{to:"/house/inbox",className:"thread__header__L",children:[Object(c.jsx)(L.e,{className:"icon icon__btn"}),Object(c.jsx)(W,{name:"threads"})]}),Object(c.jsxs)("div",{className:"thread__header__R",children:[Object(c.jsx)(l.b,{to:"/house#new",children:Object(c.jsx)(W,{name:"new thread"})}),Object(c.jsx)(C,{name:n?"close":"reply",kind:"primary",handleClick:function(){return t(!n)}})]})]})};var xn=function(e){var t=function(){var e=Object(r.useRef)(null);return{scrollRef:e,scrollToBottom:function(){e.current.scrollIntoView({behavior:"smooth"}),console.log(e.current)}}}(),n=t.scrollToBottom,a=t.scrollRef,s=Object(r.useRef)(null),o=e.handleSubmit,i=e.editorState,l=e.onNoteChange,u=e.mapKeyToEditorCommand,d=e.handleKeyCommand,j=e.toggleInlineStyle,b=e.toggleBlockType;return Object(r.useEffect)((function(){s.current.focus(),n()}),[]),Object(c.jsxs)("div",{ref:a,children:[Object(c.jsx)(mt,{editorState:i,onToggleInline:j,toggleBlockType:b,addTag:!1}),Object(c.jsx)("div",{className:"editorWrapper editorWrapper--inline",onClick:function(){return s.current.focus()},children:Object(c.jsx)(et.Editor,{ref:s,editorState:i,spellCheck:!0,handleKeyCommand:d,mapKeyToEditorCommand:u,onChange:l})}),Object(c.jsxs)("div",{className:"threadDraft__submit",children:[Object(c.jsx)(C,{name:"discard",type:"button"}),Object(c.jsx)(C,{name:"finish",type:"submit",kind:"secondary",handleClick:o})]})]})};function vn(){var e=Object(r.useState)((new Date).toLocaleDateString("en",{day:"numeric",month:"short",year:"numeric"})),t=Object(f.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(et.EditorState.createEmpty()),s=Object(f.a)(c,2),o=s[0],i=s[1],l=function(e){i(e)};return{title:n,onTitleChange:function(e){a(e.target.value)},editorState:o,setEditorState:i,onNoteChange:l,mapKeyToEditorCommand:function(e){if(9!==e.keyCode)return Object(et.getDefaultKeyBinding)(e);var t=et.RichUtils.onTab(e,o,4);t!==o&&l(t)},handleKeyCommand:function(e,t){var n=et.RichUtils.handleKeyCommand(t,e);return n?(l(n),"handled"):"not-handled"},toggleInlineStyle:function(e){e.preventDefault();var t=e.currentTarget.dataset.id;l(et.RichUtils.toggleInlineStyle(o,t))},toggleBlockType:function(e){e.preventDefault(),console.log(e.currentTarget.dataset.id);var t=e.currentTarget.dataset.id;l(et.RichUtils.toggleBlockType(o,t))},clearEditor:function(){i(et.EditorState.createEmpty())}}}var yn=function(e){var t=Object(r.useRef)(null),n=e.id,a=e.showEdit,s=e.setEditor,o=e.thread,i=vn(),l=i.editorState,u=i.onNoteChange,j=i.clearEditor,b=i.mapKeyToEditorCommand,h=i.handleKeyCommand,m=i.toggleInlineStyle,p=i.toggleBlockType,O=function(e){var t=Object(r.useContext)(d).user,n=Object(r.useState)(!0),a=Object(f.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)(null),i=Object(f.a)(o,2),l=i[0],u=i[1],j=function(){var t=Object(F.a)(D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",B.a.get("/comments/".concat(e)).then((function(e){var t=e.data.data.comments;u(t),s(!1)})).catch((function(e){return console.log(e)})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),b=function(){var n=Object(F.a)(D.a.mark((function n(a){return D.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",B.a.post("/comments",{post:e,user:t,comment:a}).then((function(e){})));case 1:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),h=function(){var e=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(t);case 2:return e.next=4,j();case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){function e(){return(e=Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),{comments:l,loading:c,handleAddComment:h}}(n),g=O.comments,x=O.loading,v=O.handleAddComment;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("hr",{}),Object(c.jsxs)("div",{className:"thread__comments",children:[!x&&g.map((function(e){var t=Object(et.convertFromRaw)(JSON.parse(e.comment)),n=et.EditorState.createWithContent(t);return Object(c.jsxs)("div",{className:"threadComment",children:[Object(c.jsxs)("div",{className:"thread__metadata",style:{paddingBottom:"0.5rem"},children:[Object(c.jsxs)("h4",{className:"thread__author",children:[" ",e.user.username," "]}),Object(c.jsxs)("h4",{className:"thread__date",children:[" ",e.createdOn," "]})]}),Object(c.jsx)(et.Editor,{editorState:n,readOnly:!0})]},e._id)})),Object(c.jsx)(z.a,{in:a,timeout:250,nodeRef:t,classNames:"rollDownFadeOut",unmountOnExit:!0,children:Object(c.jsxs)("div",{className:"threadDraft",ref:t,children:[Object(c.jsxs)("h4",{className:"heavy",children:["reply to ",o," "]}),Object(c.jsx)(xn,{setEditor:s,handleSubmit:function(e){e.preventDefault();var t=l.getCurrentContent(),n=JSON.stringify(Object(et.convertToRaw)(t));v(n),j()},editorState:l,onNoteChange:u,mapKeyToEditorCommand:b,handleKeyCommand:h,toggleInlineStyle:m,toggleBlockType:p})]})})]})]})};function _n(){var e=Object(u.h)(),t=Object(r.useState)(null),n=Object(f.a)(t,2),a=n[0],c=n[1];return Object(r.useEffect)((function(){return"#new"===e.hash?c(!0):c(!1)}),[]),{showEdit:a,setEditor:c}}var Cn=function(){var e=Object(u.i)().threadId,t=function(e){var t=Object(r.useState)(!0),n=Object(f.a)(t,2),a=n[0],c=n[1],s=Object(r.useState)(null),o=Object(f.a)(s,2),i=o[0],l=o[1],u=Object(r.useState)(et.EditorState.createEmpty()),d=Object(f.a)(u,2),j=d[0],b=d[1],h=function(){var t=Object(F.a)(D.a.mark((function t(){return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",B.a.get("/posts/".concat(e)).then((function(e){var t=e.data.data.doc;l({title:t.title,author:t.user.username,date:t.createdOn});var n=Object(et.convertFromRaw)(JSON.parse(t.content)),a=et.EditorState.createWithContent(n);return b(a),c(!1)})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return Object(r.useEffect)((function(){function e(){return(e=Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h();case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),{metadata:i,editorState:j,loading:a}}(e),n=t.loading,a=t.metadata,s=t.editorState,o=_n(),i=o.showEdit,l=o.setEditor;return Object(c.jsxs)("div",{className:"page",children:[Object(c.jsx)(gn,{setEditor:l,showEdit:i}),!n&&Object(c.jsxs)("div",{className:"thread",children:[Object(c.jsxs)("div",{className:"thread__OG",children:[Object(c.jsx)("h3",{className:"thread__title",children:a.title}),Object(c.jsxs)("div",{className:"thread__metadata",children:[Object(c.jsx)("h4",{className:"thread__author",children:a.author}),Object(c.jsx)("h4",{className:"thread__date",children:a.date})]}),Object(c.jsx)(et.Editor,{readOnly:!0,editorState:s})]}),Object(c.jsx)(yn,{id:e,setEditor:l,showEdit:i,thread:a.title})]})]})},Nn=function(e){var t=e.tag,n=e.eyedrop,a=e.handleColorSelect;return Object(c.jsx)("input",{type:"color",className:"colorInput","data-id":t._id,defaultValue:t.tagObject[0].color,disabled:!n,onBlur:function(e){return a(e)}})},wn=function(e){var t=e.tag,n=e.activeFilter;return Object(c.jsx)(ie,{in:n.includes("count"),children:Object(c.jsx)("h4",{className:"tag__count",children:t.countEach})})},kn=function(e){var t=e.tag,n=e.activeFilter;return Object(c.jsxs)("div",{className:"tag",style:n.includes("color")?{backgroundColor:t.tagObject[0].color}:{},children:[Object(c.jsx)("h4",{children:t.name}),Object(c.jsx)(Nn,Object(j.a)({},e)),Object(c.jsx)(wn,Object(j.a)({},e))]})};function En(e){var t=e.tags,n=e.tagCount,a=Object(b.a)(e,["tags","tagCount"]);return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("div",{className:"houseTags",children:t.map((function(e,t){return Object(c.jsx)("div",{style:{marginBottom:"1rem"},children:Object(c.jsx)(kn,Object(j.a)({tag:e},a))},t)}))}),Object(c.jsx)(ie,{in:a.activeFilter.includes("count"),children:Object(c.jsxs)("div",{className:"houseTags__stats",children:[Object(c.jsxs)("h4",{children:["This house has created ",n.unique," tags\xa0 "]}),Object(c.jsxs)("h4",{children:[" and used them ",n.sum," total times. "]})]})})]})}function Dn(e){return Object(c.jsxs)("menu",{className:"filter",children:[e.filters.map((function(t){return Object(c.jsx)("li",{className:"filter__item ".concat(e.activeFilter.includes(t)?"filter__item--active":""),"data-id":t,onClick:function(t){return e.handleFilterClick(t)},children:t},t)})),Object(c.jsx)("div",{className:"filter__paint ".concat(e.eyedrop?"filter__paint--active":""),children:e.activeFilter.includes("color")&&Object(c.jsx)(L.s,{className:"icon icon__btn ".concat(e.eyedrop?"icon--active":""),onClick:e.handlePaintClick})})]})}function Fn(){var e=Object(r.useContext)(d).user,t=wt("recent"),n=t.handleOneFilter,a=t.activeItem,s=function(e){var t=Object(r.useState)(e),n=Object(f.a)(t,2),a=n[0],c=n[1];return{activeFilter:a,handleFilterClick:function(e){var t,n=Object(k.a)(a),r=e.target.dataset.id;t=n.includes(r)?n.filter((function(e){return e!==r})):n.concat(e.target.dataset.id),c(t)}}}(["color"]),o=s.handleFilterClick,i=s.activeFilter,l=on(a),u=l.tags,j=l.tagCount,b=l.loading,m=function(){var e=Object(r.useContext)(d),t=e.globalTags,n=e.setGlobalTags,a=Object(r.useState)(!1),c=Object(f.a)(a,2),s=c[0],o=c[1];function i(e,t){return l.apply(this,arguments)}function l(){return(l=Object(F.a)(D.a.mark((function e(a,c){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.a.put("/tags/".concat(c),{color:a}).then((function(e){console.log(e.data.data.doc);var a=e.data.data.doc,c=t.filter((function(e){return e._id!==a._id}));n([].concat(Object(k.a)(c),[a]))})).catch((function(e){return console.log(e)})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{handlePaintClick:function(){o(!s)},handleColorSelect:function(){var e=Object(F.a)(D.a.mark((function e(t){var n,a;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.target.value),n=t.target.value,a=t.target.dataset.id,e.next=5,i(n,a);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),eyedrop:s}}(),p=m.eyedrop,O=m.handlePaintClick,g=m.handleColorSelect;return Object(c.jsxs)("div",{className:"page",children:[Object(c.jsxs)("div",{className:"houseTags__header",children:[Object(c.jsxs)("h3",{children:[e.house.house," paths"]}),Object(c.jsx)(Dn,{filters:["count","color"],activeFilter:i,handleFilterClick:o,handlePaintClick:O,eyedrop:p})]}),Object(c.jsxs)("div",{className:"layer",children:[Object(c.jsx)("div",{className:"layer__sidebar",children:Object(c.jsx)(Et,{title:"sort",list:["recent","A - Z","count"],activeItem:a,handleOneFilter:n})}),Object(c.jsxs)("div",{className:"layer__body",children:[b&&Object(c.jsx)(h,{}),!b&&0===u.length&&Object(c.jsx)("div",{className:"layer__empty",children:Object(c.jsx)("h3",{className:"light",children:"Empty room"})}),!b&&Object(c.jsx)(En,{tags:u,tagCount:j,activeFilter:i,eyedrop:p,handleColorSelect:g})]})]})]})}var Sn=function(e){var t=e.hover;return Object(c.jsxs)("div",{className:"houseNav",children:[Object(c.jsxs)("div",{className:"houseNav__A",children:[Object(c.jsx)(l.b,{to:"/library/paths",className:"A A1 ".concat(1===t?"hover":""),children:"1"}),Object(c.jsx)(l.b,{to:"/library/rooms",className:"A A2 ".concat(2===t?"hover":""),children:"2"})]}),Object(c.jsxs)("div",{className:"houseNav__B",children:[Object(c.jsx)(l.b,{to:"/library/syllabus",className:"B B1 ".concat(3===t?"hover":""),children:"3"}),Object(c.jsxs)("div",{className:"B2",children:[Object(c.jsxs)("div",{className:"B2--top",children:[Object(c.jsx)(l.b,{to:"/",className:"B B2--4 ".concat(4===t?"hover":""),children:"4"}),Object(c.jsx)(l.b,{to:"/",className:"B B2--5 ".concat(5===t?"hover":""),children:"5"})]}),Object(c.jsx)(l.b,{to:"/library/archive",className:"B B2--6 ".concat(6===t?"hover":""),children:"6"})]}),Object(c.jsx)(l.b,{to:"/library/inbox",className:"B B3 ".concat(7===t?"hover":""),children:"7"})]})]})},Tn=function(e){var t=e.house,n=e.hoverRoom;return Object(c.jsxs)("ol",{className:"house__menu",children:[Object(c.jsx)("div",{className:"dndHeader__label",children:Object(c.jsx)("h4",{className:"heavy",children:t})}),[{url:"paths",label:"Path key"},{url:"rooms",label:"Room key"},{url:"syllabus",label:"Syllabus"},{url:"",label:"Post view"},{url:"",label:"Path view"},{url:"archive",label:"Archive"},{url:"filing",label:"Mailroom"}].map((function(e,t){return Object(c.jsx)(l.b,{to:"/library/".concat(e.url),onMouseEnter:function(){return n(t+1)},onMouseLeave:function(){return n(null)},children:Object(c.jsxs)("p",{className:"dnd__item dnd__item--nested",children:[t+1,". ",e.label]})},t)}))]})},Bn=function(){var e=Object(r.useContext)(d).user.house.house,t=Object(r.useState)(null),n=Object(f.a)(t,2),a=n[0],s=n[1];return Object(c.jsxs)("div",{className:"house",children:[Object(c.jsx)(Sn,{hover:a}),Object(c.jsx)(Tn,{house:e,hoverRoom:function(e){s(e)}})]})};function An(e){var t=e.title,n=e.onTitleChange,a=e.editorState,s=e.onNoteChange,o=e.mapKeyToEditorCommand,i=e.handleKeyCommand,l=e.toggleInlineStyle,u=e.toggleBlockType,d=e.styledToolbar,j=Object(r.useRef)(null);return Object(r.useEffect)((function(){j.current.focus()}),[]),Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(mt,{editorState:a,onToggleInline:l,toggleBlockType:u,addTag:!1,styled:d}),Object(c.jsxs)("div",{className:"editorWrapper--block",children:[Object(c.jsx)("input",{type:"text",className:"input editor__title",disabled:!1,name:"title",value:t,onChange:n,onKeyDown:function(e){13===e.keyCode&&e.preventDefault()}}),Object(c.jsx)("div",{className:"editorWrapper",onClick:function(){return j.current.focus()},children:Object(c.jsx)(et.Editor,{editorState:a,ref:j,spellCheck:!0,onChange:s,handleKeyCommand:i,mapKeyToEditorCommand:o})})]})]})}function Rn(e){var t=e.post,n=e.plaintext,a=e.props.handleLibraryBookDelete;return Object(c.jsxs)("div",{className:"inboxPreview",children:[Object(c.jsxs)("div",{className:"inboxPreview__text",children:[Object(c.jsx)("p",{className:"inboxPreview__subject",children:t.title}),Object(c.jsx)("p",{className:"inboxPreview__body",children:n}),Object(c.jsx)("div",{className:"inboxPreview__fade"})]}),Object(c.jsx)(L.i,{className:"icon icon__btn inboxPreview__X","data-id":t._id,onClick:function(e){e.preventDefault(),a(e)}})]})}var Ln=function(e){var t=e.post;return Object(c.jsx)(l.b,{to:{pathname:"/house/".concat(t._id),state:t},children:Object(c.jsx)(Rn,Object(j.a)({},e))})};function In(e){var t=e.pageState,n=e.handlePageCounter,a=t.page,r=t.totalPages,s=t.prevPage,o=t.nextPage;return Object(c.jsx)(c.Fragment,{children:r&&r>1?Object(c.jsxs)("div",{className:"paginate",children:[s&&Object(c.jsx)(L.c,{className:"icon icon__btn paginate__L",onClick:function(){return n(a-1)}}),r&&r>1&&Object(c.jsxs)("h4",{className:"paginate__pg",children:[a," of ",r]}),o&&Object(c.jsx)(L.d,{className:"icon icon__btn paginate__R",onClick:function(){return n(a+1)}})]}):null})}function Pn(e){var t=e.threads;return Object(c.jsx)("div",{className:"inbox",children:t&&t.length>0?Object(c.jsxs)("div",{children:[t.map((function(t,n){var a=Object(et.convertFromRaw)(JSON.parse(t.content)).getPlainText();return Object(c.jsx)(Ln,{post:t,plaintext:a,props:e},n)})),Object(c.jsx)(In,Object(j.a)({},e))]}):Object(c.jsx)("div",{className:"light",children:"No threads"})})}function Kn(){var e=Object(r.useRef)(null),t=function(e){var t=Object(r.useContext)(d).user,n=t.house._id,a=Object(r.useState)(null),c=Object(f.a)(a,2),s=c[0],o=c[1],i=Object(r.useState)({page:1,totalPages:null,prevPage:null,nextPage:null}),l=Object(f.a)(i,2),u=l[0],j=l[1],b=function(){var t=Object(F.a)(D.a.mark((function t(a,c){var r;return D.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=(a-1)*e,t.abrupt("return",B.a.get("/posts/paginate/".concat(n,"/library?offset=").concat(r,"&limit=").concat(e)).then((function(e){var t=e.data.data.docs,n=t.docs,a=t.page,r=t.totalPages,s=t.prevPage,i=t.nextPage;o(n),a>r&&b(r),c&&i&&b(r),j({page:a,totalPages:r,prevPage:s,nextPage:i})})).catch((function(e){return console.log(e)})));case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),h=function(){var e=Object(F.a)(D.a.mark((function e(a,c){var r;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=JSON.stringify(Object(et.convertToRaw)(a)),e.abrupt("return",B.a.post("/posts",{type:"library",room:"library",title:c,content:r,user:t,house:n}).catch((function(e){return console.log(e)})));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),m=function(){var e=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.a.delete("/posts/".concat(t)).then(function(){var e=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,B.a.get("/posts/h/".concat(n,"/library"));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return console.log(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();function p(){return(p=Object(F.a)(D.a.mark((function e(t){var n;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.currentTarget.dataset.id,console.log(t.currentTarget),e.next=4,m(n);case 4:return e.next=6,b(u.page);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(){return(O=Object(F.a)(D.a.mark((function e(t,n){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t,n);case 2:return e.next=4,b(u.page,!0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){return(g=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:b(t);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return{handleLibrarySubmit:function(e,t){return O.apply(this,arguments)},getLibraryBooks:b,handleLibraryBookDelete:function(e){return p.apply(this,arguments)},threads:s,pageState:u,handlePageCounter:function(e){return g.apply(this,arguments)}}}(6),n=t.getLibraryBooks,a=t.handleLibrarySubmit,s=t.threads,o=t.handleLibraryBookDelete,i=t.pageState,l=t.handlePageCounter;Object(r.useEffect)((function(){n(1)}),[]);var u=_n(),j=u.showEdit,b=u.setEditor,h=vn(),m=h.title,p=h.onTitleChange,O=h.editorState,g=h.onNoteChange,x=h.clearEditor,v=h.mapKeyToEditorCommand,y=h.handleKeyCommand,_=h.toggleInlineStyle,N=h.toggleBlockType;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)("h2",{className:"page__title",style:{marginLeft:0},children:"House"}),Object(c.jsxs)("div",{className:"layer inmail",children:[Object(c.jsx)("div",{className:"house__compose",children:j?Object(c.jsx)(W,{name:"close",handleClick:function(){return b(!j)}}):Object(c.jsx)(C,{name:"new thread",kind:"primary",handleClick:function(){return b(!j)}})}),Object(c.jsx)(z.a,{in:j,timeout:350,nodeRef:e,classNames:"rollDownFadeOut",unmountOnExit:!0,children:Object(c.jsxs)("form",{style:{transformOrigin:"top"},onSubmit:function(e){e.preventDefault();var t=O.getCurrentContent();a(t,m),x(),b(!1)},ref:e,children:[Object(c.jsx)(An,{title:m,onTitleChange:p,editorState:O,onNoteChange:g,mapKeyToEditorCommand:v,handleKeyCommand:y,toggleInlineStyle:_,toggleBlockType:N,styledToolbar:!0}),Object(c.jsx)("div",{className:"inlineForm__submit",style:{justifyContent:"flex-end"},children:Object(c.jsx)(C,{name:"finish",kind:"primary",type:"submit"})})]})}),Object(c.jsx)("h4",{className:"heavy",style:{paddingBottom:"0.5rem",cursor:"pointer"},onClick:function(){return l(1)},children:"threads"}),Object(c.jsx)(Pn,{threads:s,handleLibraryBookDelete:o,pageState:i,handlePageCounter:l})]})]})}var Mn=function(e){var t="flex-start",n="stretch";return Object(c.jsx)("div",{style:function(e){var a=e.inline,c=e.column,r=e.top,s=e.middle,o=e.bottom,i=e.left,l=e.center,u=e.right,d=e.between,j=e.around,b=e.gap,h=e.width;return(i||l||u||d||j)&&(i?t="flex-start":l?t="center":u?t="flex-end":d?t="space-between":j&&(t="space-around")),(r||s||o)&&(r?n="flex-start":s?n="center":o&&(n="flex-end")),c&&((i||l||u)&&(i?n="flex-start":l?n="center":u&&(n="flex-end")),(r||s||o||d||j)&&(r?t="flex-start":s?t="center":o?t="flex-end":d?t="space-between":j&&(t="space-around"))),{display:a?"inline-flex":"flex",flexDirection:c?"column":"row",justifyContent:t,alignItems:n,width:h||"auto",gap:"".concat(b,"rem")}}(e),className:e.className,children:e.children})},zn=function(e){var t=Object(r.useRef)(null);return Object(c.jsx)(z.a,{in:e.in,timeout:350,nodeRef:t,classNames:"grow",unmountOnExit:!0,children:Object(c.jsx)("span",{ref:t,children:e.children})})},Un=function(e){var t=e.c,n=e.handleOpen;return Object(c.jsx)("h3",{className:"warp__stitch",onClick:function(){return n(t.id)},children:t.text})},Hn=function(e){var t=e.row,n=e.handleOpen,a=e.open,r=t.components,s=t.right,o=t.left;return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(Mn,{className:"syllabus__row",width:"100%",children:Object(c.jsx)("div",{className:"warp",style:{left:o,right:s},children:r.map((function(e,t){return Object(c.jsx)(Un,{c:e,handleOpen:n},t)}))})}),Object(c.jsx)("div",{className:"warp__dropdown",children:r.length&&r.map((function(e,t){return Object(c.jsx)(zn,{in:a[e.id],children:Object(c.jsx)("div",{className:"warp__dropdown__cell",children:e.dropdown},t)})}))})]})},Gn=[{components:[{id:0,text:"Memory palaces",dropdown:"yoyoyo"},{id:1,text:"Club Penguin & Animal Crossing",dropdown:"yoyoyo"}],right:"",left:"0"},{components:[{id:2,text:"My website is a shifting house next to a river of knowledge. What could yours be?",dropdown:"???!!"}],right:"",left:"0"}],qn=function(){var e=Gn.map((function(e){return e.components})),t=Object(r.useState)(e.flat().map((function(e){return!1}))),n=Object(f.a)(t,2),a=n[0],s=n[1],o=function(e){var t=Object(k.a)(a);t[e]=!t[e],s(t)};return Object(c.jsx)(c.Fragment,{children:Object(c.jsx)("div",{className:"syllabus",children:Gn.map((function(e,t){return Object(c.jsx)(Hn,{row:e,open:a,handleOpen:o},t)}))})})},Wn=[{symbol:Object(c.jsx)(fe.default,{l:"1.5rem"}),label:"A group, which may contain layers."},{symbol:Object(c.jsx)(L.r,{className:"keyIcon"}),label:"A path, which connects posts across layers."}],Zn=function(){var e=Object(r.useContext)(d).groups.map((function(e){return e.layers}));return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsxs)("div",{className:"key symbolKey",children:[Object(c.jsx)("h3",{className:"houseTitle key__title",children:"Rooms and signs"}),Wn.map((function(e,t){return Object(c.jsxs)("div",{className:"key__row",children:[e.symbol,e.label]},t)})),e.flat().map((function(e){return Object(c.jsxs)("div",{className:"key__row",children:[Object(c.jsx)(_e,{l:"1.5rem",id:"L".concat(e.id)}),e.label]},e.slug)}))]}),Object(c.jsxs)("div",{className:"key symbolKey",children:[Object(c.jsx)("h3",{className:"houseTitle key__title",children:"All path colors"}),fn.map((function(e){return Object.entries(e).map((function(e){var t=Object(f.a)(e,2),n=t[0],a=t[1];return Object(c.jsxs)("div",{className:"key__row",children:[n,a.map((function(e){return Object(c.jsx)("div",{className:"key__color",style:{backgroundColor:e}},e)}))]},n)}))}))]})]})},Vn=function(){var e=se(),t=e.getHousePosts,n=e.posts,a=e.loading;function s(e){return o.apply(this,arguments)}function o(){return(o=Object(F.a)(D.a.mark((function e(n){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t(n);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(r.useEffect)((function(){function e(){return(e=Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t(1);case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),a?null:Object(c.jsxs)("div",{children:[Object(c.jsx)("h2",{className:"houseTitle",children:"Archive"}),n.docs.map((function(e){var t;if("note"===e.type){var a=Object(et.convertFromRaw)(JSON.parse(e.content)),r=et.EditorState.createWithContent(a);t=Object(c.jsx)(et.Editor,{editorState:r,readOnly:!0})}else t=e.content;return Object(c.jsxs)("span",{children:[Object(c.jsxs)(ce,{columns:"10% 10% 1fr",gap:1,children:[Object(c.jsx)("div",{className:"archive__col",children:Object(c.jsx)("h4",{children:e.date})}),Object(c.jsx)("div",{className:"archive__col",children:Object(c.jsx)("h4",{children:e.user.username})}),Object(c.jsx)("div",{className:"archive__col",children:t})]}),Object(c.jsx)(In,{pageState:n,handlePageCounter:s})]},e._id)}))]})},Xn=function(){return Object(c.jsxs)("div",{className:"page",children:[Object(c.jsx)(ae,{nav:[{name:"library",url:"library"}]}),Object(c.jsxs)(u.d,{children:[Object(c.jsx)(u.b,{exact:!0,path:"/library",component:Bn}),Object(c.jsx)(u.b,{path:"/library/paths",component:Fn}),Object(c.jsx)(u.b,{exact:!0,path:"/library/rooms",component:Zn}),Object(c.jsx)(u.b,{exact:!0,path:"/library/archive",component:Vn}),Object(c.jsx)(u.b,{exact:!0,path:"/library/inbox",component:Kn}),Object(c.jsx)(u.b,{exact:!0,path:"/library/syllabus",component:qn}),Object(c.jsx)(u.b,{path:"/library/:threadId",component:Cn})]})]})};var Jn=function(){var e=Object(u.i)(),t=function(){var e=Object(r.useState)(null),t=Object(f.a)(e,2),n=t[0],a=t[1];return{path:n,getPath:function(){var e=Object(F.a)(D.a.mark((function e(t){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",B.a.get("/tags/s/".concat(t)).then((function(e){a(e.data.data.doc)})).catch((function(e){return console.log(e)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}}(),n=t.path,a=t.getPath;Object(r.useEffect)((function(){a(e.path)}),[e]);var s=Object(r.useState)("100%"),o=Object(f.a)(s,2),i=o[0],l=o[1];return Object(c.jsx)(c.Fragment,{children:n&&Object(c.jsxs)("div",{className:"page",children:[Object(c.jsx)(ae,{nav:[{name:n.tag,url:e.path}]}),Object(c.jsx)("div",{className:"page__info",children:Object(c.jsx)("div",{className:"page__title",style:{paddingLeft:"1rem"},children:n.tag})}),Object(c.jsxs)("div",{className:"layer",children:[Object(c.jsx)(St,{setZoomFilter:function(e){return l(e.currentTarget.dataset.id)}}),Object(c.jsx)("div",{className:"layer__body",children:Object(c.jsx)(Gt,{path:n,activeView:i})})]})]})})},Yn=function(){return Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(u.d,{children:Object(c.jsx)(u.b,{path:"/path/:path/:postId",component:xt})}),Object(c.jsx)(Jn,{})]})};function $n(){return Object(c.jsx)("div",{children:"This is not a route yet."})}var Qn=function(){return Object(c.jsx)(l.b,{to:"/",className:"homeButton",children:Object(c.jsx)(We,{icon:Object(c.jsx)(L.m,{className:"icon icon__btn","data-id":"house"})})})};var ea=function(){var e=function(){var e=Object(r.useState)(null),t=Object(f.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(null),s=Object(f.a)(c,2),o=s[0],i=s[1],l=Object(r.useState)(null),u=Object(f.a)(l,2),d=u[0],j=u[1],b=Object(r.useState)(null),h=Object(f.a)(b,2),m=h[0],p=h[1],O=Object(r.useState)(!0),g=Object(f.a)(O,2),x=g[0],v=g[1];return Object(r.useEffect)((function(){function e(){return(e=Object(F.a)(D.a.mark((function e(){return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.a.get("/user").then((function(e){var t=e.data.currentUser,n=e.data.currentUser.house.groups;a(t),p(n);var c=n.map((function(e){return e.layers}));return j(c.flat()),B.a.get("/tags/h/".concat(t.house._id))})).then((function(e){var t=e.data.data.results;i(t),v(!1)})).catch((function(e){console.log(e),v(!1)}));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),{user:n,rooms:d,groups:m,globalTags:o,setUser:a,setRooms:j,setGroups:p,setGlobalTags:i,isLoading:x}}(),t=e.user,n=e.rooms,a=e.groups,s=e.globalTags,o=e.setUser,i=e.setRooms,j=e.setGroups,b=e.setGlobalTags,h=e.isLoading;return Object(c.jsx)(l.a,{children:Object(c.jsxs)(d.Provider,{value:{user:t,rooms:n,groups:a,globalTags:s,setUser:o,setRooms:i,setGroups:j,setGlobalTags:b,isLoading:h},children:[Object(c.jsxs)(u.d,{children:[Object(c.jsx)(u.b,{path:"/home",component:ne}),Object(c.jsx)(u.b,{path:"/register",component:H}),Object(c.jsx)(u.b,{path:"/login",component:G}),Object(c.jsx)(u.b,{path:"/confirm",component:q}),Object(c.jsx)(p,{exact:!0,path:"/",component:Qe}),Object(c.jsx)(p,{path:"/library",component:Xn}),Object(c.jsx)(p,{path:"/path/:path",component:Yn}),Object(c.jsx)(p,{path:"/group/:group",component:Xt}),Object(c.jsx)(p,{path:"/user",component:$t}),Object(c.jsx)(p,{path:"/add",component:On}),Object(c.jsx)(p,{path:"/:room",component:Wt}),Object(c.jsx)(u.b,{component:$n})]}),Object(c.jsx)(Qn,{})]})})};B.a.defaults.headers.post["Content-Type"]="application/json",i.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(ea,{})}),document.getElementById("root"))},74:function(e,t,n){"use strict";n.r(t);var a=n(1);n(2);t.default=function(e){var t=e.l,n=e.name;return Object(a.jsx)("svg",{width:t,height:t,viewBox:"0 0 100 100",fill:"none",className:n,xmlns:"http://www.w3.org/2000/svg",children:Object(a.jsx)("rect",{x:"0.5",y:"0.5",width:"100",height:"100",stroke:"currentColor",strokeDasharray:"20",strokeWidth:"10"})})}}},[[415,32,33]]]);
//# sourceMappingURL=main.67180fec.chunk.js.map